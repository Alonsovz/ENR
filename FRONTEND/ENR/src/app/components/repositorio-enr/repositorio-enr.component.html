
<!--div para cálculo-->
<div class="row animated fadeInLeft" style="display:none;margin-left: 30px; margin-right: 30px;" id="titleCalculo">
  <div class="col-lg-12">
   
      <div class="row">
        <div class="col-lg-10" style="text-align: left;font-size: 20px;color:#49F7DD;font-weight: bold;">
         <img src="./assets/imagenes/moneyCalc.png" height=35>
         Cálculo de ENR
        </div>
        
        <div class="col-lg-2">
          <button class="btn btn-danger pull-right btn-block" 
          data-toggle="modal" data-target="#cancelarGuardadoCalculo">
            <i class="fa fa-times"></i>
            Cerrar
        </button>
        </div>
      </div>
      <hr style="background-color: #49F7DD !important; height: 2px;">

      <div class="row">
        <div class="col-lg-3">
         <h5 style="color:#02FF20; text-align: right;">Base de cálculo </h5>
        </div>
        <div class="col-lg-9">
          <h6 style="color:#00EB79; text-align: left;"> {{datosGenerales.codBase}} -- 
            {{datosGenerales.metodologiaENR}}
          <a style="float: right !important; color: yellow;"> NIS:
             <a style="float: right !important; color: #00FFEA;"> &nbsp; {{datosGenerales.nis}}
            </a>
        </a>
          <br>
          <a style="float: right !important; color: yellow;"> Tarifa:
            <a style="float: right !important; color: #00FFEA;" id="tarifaNis"> &nbsp; {{datosGenerales.tarifa}}
           </a>
          </a>
          <br>
          <a style="float: right !important; color: yellow;"> Usuario creación:
            <a style="float: right !important; color: #00FFEA;" id="tarifaNis"> &nbsp; {{datosGenerales.usuarioCreacion}}
           </a>
           </a>
        </h6>
        </div>
      </div>


      <div class="row" *ngFor="let dg  of ordenNumeroCalculo">
        <div class="col-lg-3">
          <h6 style="color:#02FF20;text-align: right;margin-top: 10%;font-weight: bold;">Período de recuperación ENR </h6>
        </div>
        <div class="col-lg-9">
          <div class="row">
            <div class="col-lg-12">
              <div class="form-group row">
                <label class="col-sm-2 col-form-label" 
                  style="text-align: right !important;color:#00EB79 !important;font-weight: bold !important;">
                  <i class="fas fa-calendar-alt"></i> Fecha de Inicio :
                </label>
                <div class="col-sm-10">
                  <label class="col-sm-2 col-form-label" style="text-align: left !important;">{{dg.fechaIni}}</label>
                </div>
              </div>
             
            </div>
            <div class="col-lg-11" style="border-bottom: 1px solid white;border-bottom-style:dashed;">
              <div class="form-group row">
                <label class="col-sm-2 col-form-label" 
                  style="text-align: right !important;color: #00EB79 !important;font-weight: bold !important;">
                  <i class="fas fa-calendar-alt"></i> Fecha Fin :
                </label>
                <div class="col-sm-10">
                  <label class="col-sm-2 col-form-label" style="text-align: left !important;">{{dg.fechaFini}}</label>
                </div>
              </div>
            </div>
            
            <div class="col-lg-12">
              <div class="form-group row">
                <label class="col-sm-2 col-form-label" 
                  style="text-align: right !important;color:#00FFEA !important;font-weight: bold !important;">
                  <i class="fas fa-dollar-sign"></i> Días de Cobro :
                </label>
                <div class="col-sm-10">
                  <label class="col-sm-2 col-form-label" style="text-align: left !important;">{{dg.diasCobro}}</label>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        
        <form [formGroup]='frm_Caso1' *ngIf ="datosGenerales.codBase == 'CD'">
              <div class="row" style="margin-left: 30px; margin-right: 30px;">
                <div class="col-md-12">
                  <hr style="background-color: #A16EFF !important; height: 2px;">
                </div>
                <div class="col-md-3">
                  <label> Amperaje Línea 1</label>
                  <input type="number" step="0.01" class="form-control" autocomplete="off" placeholder="Amperaje Línea 1" formControlName="amperaje1" name="amperaje1">
                  <input type="hidden" formControlName="idCaso" [(ngModel)]="dg.id">
                </div>
                <div class="col-md-3">
                  <label> Voltaje Línea 1</label>
                  <input type="number" step="0.01" class="form-control" autocomplete="off" placeholder="Amperaje Línea 1" formControlName="voltaje1" name="voltaje1">
                  
                </div>
                <div class="col-md-3">
                  <label> Amperaje Línea 2</label>
                  <input type="number" step="0.01" class="form-control" autocomplete="off" placeholder="Amperaje Línea 1" formControlName="amperaje2" name="amperaje2">
                  
                </div>
                <div class="col-md-3">
                  <label> Voltaje Línea 2</label>
                  <input type="number" step="0.01" class="form-control" autocomplete="off" placeholder="Voltaje Línea 2" formControlName="voltaje2" name="voltaje2">
                </div>
                <div class="col-md-3 mt-5 mb-3">
                  <label> Voltaje del Suministro</label>
                  <input type="text" class="form-control" formControlName="voltajeSuministro"
                   name="voltajeSuministro" [(ngModel)]="dg.voltajeSuministro" readonly>
                   <input type="hidden" class="form-control" formControlName="diasCobroCaso1"
                   name="diasCobroCaso1" [(ngModel)]="dg.diasCobro" readonly>
                </div>
                <div class="col-md-3 mt-5 mb-3">
                  <label> Horas estimadas (15 hrs máximo)</label>
                  <input (keyup)="esconderSpan()" type="number" step="0.01" class="form-control" autocomplete="off" placeholder="Horas estimadas" formControlName="horasEstimadas" name="horasEstimadas">
                  <span id="sHorasValidator" class="badge badge-danger" style=" text-align:center; margin:auto;
                  display: none;"> Completa este campo</span>
                </div>
                <div class="col-md-3 mt-5 mb-3">
                  <label>Consumo Registrado</label>
                  <input type="number" step="0.01" class="form-control" formControlName="consumoENRRegistrado"
                  placeholder="Digíte el consumo registrado" (keyup)="hideTotales1()">
                 </div>
                 
                <div class="col-md-3 mt-5 mb-3">
                  <label style="color: #1B1B38 !important">Calcular </label>
                  <button class="btn btn-default btn-block save" (click)="calcularENRCaso1()"
                  style="font-weight: bold !important;"> <i class="fas fa-calculator"></i> Calcular ENR </button>
                </div>
              </div>
            
              <form [formGroup]="frm_LecturasEvaluarTotales" style="width: 100% !important;" id="frmLecTotales">
              <div id="resultCaso1" class="row mt-5 animated flipInX" 
              style="margin-left: 30px; margin-right: 30px;display: none;">
             
               
                <h4 style="color: #FB8181">
                  <img src="./assets/imagenes/dataResult.png"
                  style="margin-bottom: 10px;margin-top: 7px;margin-left: 20px;" height=35>
                  Resultados obtenidos</h4>
                 <div class="col-md-12">
                  <hr style="background-color: #FC4343 !important; height: 2px;">
                 </div>
                 <div class="col-md-3 mb-5">
                  <label style="font-size: 13px !important;color:#FC4343 !important;font-weight: bold;">Consumo Diario Estimado_L1 (kwh)</label>
                  <input type="text" class="form-control" formControlName="consumo1" name="consumo1" readonly>
                 </div>
                 <div class="col-md-3 mb-5">
                  <label style="font-size: 13px !important;color:#FC4343 !important;font-weight: bold;">Consumo Diario Estimado_L2 (kwh)</label>
                  <input type="text" class="form-control" formControlName="consumo2" name="consumo2" readonly>
                 </div>

                 <div class="col-md-3 mb-5">
                  <label style="font-size: 13px !important;color:#FC4343 !important;font-weight: bold;">Consumo Registrado</label>
                  <input type="text" class="form-control" formControlName="consumoENRRegistrado" readonly>
                 </div>

                 
                 <div class="col-md-3 mb-5">
                  <label style="font-size: 13px !important;color:#FC4343 !important;font-weight: bold;">Consumo Total ENR (kwh)</label>
                  <input type="text" class="form-control" formControlName="consumoENRFacturar" name="consumoENRFacturar" readonly>

                  <input type="hidden" formControlName="numeroCaso">
                  <input type="hidden" formControlName="idCaso" [(ngModel)]="dg.id">
                 </div>
             
              </div>
            </form>
              
        </form>
        
        <form [formGroup]='frm_Caso2' *ngIf="datosGenerales.codBase == 'CN'" style="width: 100% !important;">
          <div class="row" style="margin-left: 30px; margin-right: 30px;">
            <div class="col-lg-12">
              <hr style="background-color: #A16EFF !important; height: 2px;">
            </div>
            <div class="col-md-4">
              <input type="hidden" formControlName="idCaso" [(ngModel)]="dg.id">
              <label> Censo de Carga Estimado (Mensual en kwh)</label>
              <input type="text" mask="0*.0*" class="form-control"  (keyup)="calcularConDiarioENR1()"
              autocomplete="off" placeholder=" Censo de Carga Estimado" formControlName="censoCarga" name="censoCarga">
              
            </div>
            <div class="col-md-3">
              <label> Consumo Diario Estimado (kwh)</label>
              <input type="number" step="0.01" readonly class="form-control" placeholder="Consumo Diario Estimado" formControlName="consumoEstimado" name="consumoEstimado">
            </div>
              
            <div class="col-md-3">
              <label> Voltaje del Suministro</label>
                  <input type="text" class="form-control" formControlName="voltajeSuministro"
                   name="voltajeSuministro" [(ngModel)]="dg.voltajeSuministro" readonly>
                   <input type="hidden" class="form-control" formControlName="diasCobroCaso2"
                   name="diasCobroCaso2" [(ngModel)]="dg.diasCobro" readonly>
            </div>

            <div class="col-md-2">
              <label>Consumo Registrado</label>
              <input type="number" step="0.01" class="form-control" formControlName="consumoENRRegistrado"
              placeholder="Consumo registrado" (keyup)="totalizarDato()" disabled>
             </div>

            <div class="col-md-12">
              <hr style="background-color: #DFA714 !important; height: 2px;">
              <button class="btn btn-warning" (click)="mostrarLecturas(dg,2)"
               style="font-weight: bold;display: none" id="btnSelecLecturasCaso2"> 
              <i class="fas fa-search"></i>
               Seleccione los períodos  de facturación a comparar 
              </button>
            </div>
           
          </div>
          
          <form [formGroup]="frm_LecturasEvaluar" class="animated fadeInDown" style="display: none;margin-left: 30px;margin-right: 30px;" id="frmLec">       
            
              <hr style="background-color: #4C9AFD !important; height: 2px;">
            
            <h4 style="color: #4C9AFD;margin-top: 5px;"> 
              <img src="./assets/imagenes/light-bulb.png" height=35>
              Períodos seleccionados  = <a style="color:yellow !important;">{{totalSeleccion}}</a></h4>
            <table class="table small mt-3">
                <thead class="thead-dark">
                    <tr >
                        <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                        border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                            Período
                        </th>
                        <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                        border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                         Fecha Lectura Ant.
                        </th>
                        <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                        border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                            Fecha Lectura
                        </th>
                        <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                        border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                            Días Facturados
                        </th>
                        <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                        border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                            Consumo
                        </th>
                        <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                        border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                            Consumo no Fact.
                        </th>
                        <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                        border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                        
                           Dif. de consumo
                        </th>
                    </tr>
                </thead>
                <tbody  formArrayName="lecturas"
                style="background-color:#222245; color:white;text-align: center;
                font-size: 14px;">
                    <tr *ngFor="let item of lecturas.controls; let pointIndex=index" [formGroupName]="pointIndex">
                        <td style="border-bottom: 1px solid #A4FA98;">
                          <input type="hidden" formControlName="idCaso">
                          <input class="form-control" type="text" formControlName="periodo"
                          style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                        </td>
                        <td style="border-bottom: 1px solid #FAFD4F;">
                          <input class="form-control" type="text" formControlName="fechaLecturaAnt"
                            style="text-align: center !important;color: #FAFD4F !important;" readonly="true">
                        </td>
                        <td style="border-bottom: 1px solid #A4FA98;">
                            <input class="form-control" type="text" formControlName="fechaLectura"
                            style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                        </td>
                        <td style="border-bottom: 1px solid #FAFD4F;">
                          <input class="form-control" type="text" formControlName="diasFacturados" name="diasFacturados"
                          style="text-align: center !important;color: #FAFD4F !important;" readonly="true">
                        </td>
                        <td style="border-bottom: 1px solid #A4FA98;">
                          <input class="form-control" type="text" formControlName="consumo" name="consumo"
                          style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                        </td>
                        <td style="border-bottom: 1px solid #FAFD4F;">
                          <input class="form-control" type="text" formControlName="consumoNoFac" name="consumoNoFac"
                          style="text-align: center !important;color: #FAFD4F !important;" readonly="true">
                        </td>
                        <td style="border-bottom: 1px solid #A4FA98;">
                          <input class="form-control" type="text" formControlName="difConsumo" name="difConsumo"
                          style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                          <button class="btn btn-danger btn-sm btn-circle" id="btnEl{{item.value.periodo}}"
                          style="display: none;"
                          (click)="eliminarLectura(pointIndex,item.value.periodo)"><i class="fas fa-trash"></i></button>
                        </td>
                       
                    </tr>
                    
                </tbody>
                
            </table>
        </form>
        
        <form [formGroup]="frm_LecturasEvaluarTotales" style="display: none;" id="frmLecTotales">
          <div class="row" style="margin-right: 30px;margin-left: 30px;margin-top: 10px;">
            
            <table class="table">
              <thead class="thead-dark">
                <tr>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                    border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center"></th>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                    border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center"></th>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                    border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center"></th>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                          border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center">
                              Días Facturados
                    </th>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                    border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center">
                        Consumo
                    </th>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                    border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center">
                        Consumo no Fact.
                    </th>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                    border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center">
                    
                       Dif. de consumo
                    </th>
                </tr>
            </thead>
            <tbody style="background-color: #1B1B38 !important;">
              <tr style="background-color: #1B1B38 !important;">
                <td colspan="3"> <h6 style="color:#FF9B00; font-size: 14px;text-align: right;
                  font-weight: bold;"> Totales</h6></td>
                <td>
                  <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                  formControlName="totalDias">
                </td>
                <td>
                  <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                  formControlName="totalConsumo">
                </td>
                <td>
                  <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                  formControlName="totalConsumoNF">
                </td>
                <td>
                  <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                  formControlName="totalDifConsumo">
                </td>
              </tr>
            </tbody>
             
             
              
            </table>
          </div>
         

          <div class="row" style="margin-right: 30px;margin-left: 30px;margin-bottom: 15px;">
            <div class="col-md-12">
              <hr style="background-color: #4C9AFD !important; height: 2px;">
              <h4 style="color: #FB8181">
                <img src="./assets/imagenes/dataResult.png" height=35>
                Resultados obtenidos</h4>
            </div>
              
              <div class="col-md-4">
                <label style="font-size: 15px !important;color:#FC4343 !important;font-weight: bold;">Consumo ENR_Diario (kwh Diario)</label>
                <input class="form-control" type="text" formControlName="consumoDiarioENR" name="consumoDiarioENR"
                style="text-align: center !important;" readonly="true">
              </div>
              <div class="col-md-4">
                <label style="font-size: 13px !important;color:#FC4343 !important;font-weight: bold;">Consumo Registrado</label>
                <input type="text" class="form-control" formControlName="consumoENRRegistrado" readonly>
               </div>

              <div class="col-md-4">
                <label style="font-size: 15px !important;color:#FC4343 !important;font-weight: bold;">Consumo ENR a facturar (kwh total)</label>
                <input class="form-control" type="text" formControlName="consumoENRFacturar" name="consumoENRFacturar"
                style="text-align: center !important;" readonly="true">
                <input type="hidden" formControlName="numeroCaso">
                <input type="hidden" formControlName="idCaso" [(ngModel)]="dg.id">
              </div>
              <div class="col-md-1"></div>
            
          </div>
        </form>
        </form>
         
        <form [formGroup]='frm_Caso3' *ngIf ="datosGenerales.codBase == 'MP'" style="width: 100% !important;">"H>I"
          

          <div class="row" style="margin-left: 30px; margin-right: 30px;">
            <div class="col-md-12">
              <hr style="background-color: #A16EFF !important; height: 2px;">
            </div>
            <input type="hidden" class="form-control" formControlName="diasCobroCaso3"
            name="diasCobroCaso3" [(ngModel)]="dg.diasCobro" readonly>
            <input type="hidden" formControlName="idCaso" [(ngModel)]="dg.id">
            <div class="col-md-6">
                <h5 style="color: #A16EFF;margin-top: 5px;"> 
                <img src="./assets/imagenes/idea3.png" height=35>
                Consumos REALES del usuario (Sin irregularidad) </h5>
           
              <button style="float: right !important;margin-bottom: 5px !important;"
               class="btn btn-success btn-sm" (click)="agregarConsumoReal()">
               <i class="fas fa-plus"></i>
              </button>
              <form [formGroup]="frm_ConsumosReales3">
                <table class="table small mt-3">
                  <thead class="thead-dark">
                      <tr >
                          <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                          border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                              Período
                          </th>
                          <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                          border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                          Consumo Registrado
                          </th>
                          <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                          border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                             Días
                          </th>
                          <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                          border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                          </th>                   
                      </tr>
                  </thead>
                 
                  <tbody  formArrayName="consumosReales3"
                  style="background-color:#222245; color:white;text-align: center;
                  font-size: 14px;">
                      <tr *ngFor="let item of consumosReales3.controls; let pointIndex=index" [formGroupName]="pointIndex">
                          <td style="border-bottom: 1px solid #A4FA98;">
                            <input class="form-control" type="text"  mask="0*" formControlName="periodo" placeholder="Período"
                            style="color: #A4FA98 !important;">
                            <input type="hidden" formControlName="idCaso">
                          </td>
                          <td style="border-bottom: 1px solid #FAFD4F;">
                            <input class="form-control" type="number" step="0.01" formControlName="consumoRegistradoCT3" name="consumoRegistradoCT3" placeholder="Consumo"
                              style="color: #FAFD4F !important;">
                          </td>
                          <td style="border-bottom: 1px solid #A4FA98;">
                              <input class="form-control" type="number" autocomplete="off" formControlName="diasCT3" name="diasCT3" placeholder="Días"
                              style="color: #A4FA98 !important;">
                          </td>
                       
                        
                          <td style="border-bottom: 1px solid #FAFD4F;">
                            <button class="btn btn-danger btn-sm btn-circle"
                            (click)="eliminarConsumoReal(pointIndex)"><i class="fas fa-trash"></i></button>
                          </td>
                         
                      </tr>
                      
                  </tbody>
                </table>
              </form>
              
                <button (click)="totalizarConsumosReales3()" style="float: right !important"
                class="btn btn-info btn-sm"><i class="fas fa-calculator"></i>
                Totalizar</button>
             
              
            
              
            </div>
            <div class="col-md-6" style="margin-top: 32px;">
              <div class="row">
                

                <div class="col-md-12 animated flipInX" id="totalesConsumoCT3" style="display: none;">
                  <form [formGroup]="frm_ConsumosReales3Totales" style="width: 100% !important;">
                    <div class="row">
                      <div class="col-md-12">
                        <h4 style="color:#FB51EE; text-align: left;">Totales</h4>
                    </div>
                    <div class="col-md-6">
                      <label style="color:coral !important; text-align: center !important;font-weight: bold !important;">Consumo Registrado</label>
                        <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                        formControlName="totalConsumoCT3">
                        <input type="hidden" formControlName="idCaso" [(ngModel)]="dg.id">
                    </div>
                    <div class="col-md-6">
                      <label style="color:coral !important; text-align: center !important;font-weight: bold !important;">Días</label>
                      <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                      formControlName="totalDiasCT3">
                    </div>

                    <div class="col-md-6">
                      <label style="color:#FC4343 !important; text-align: center !important;font-weight: bold !important;">Consumo Estimado Mensual</label>
                        <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                        formControlName="totalConsumoEstimadoCT3">
                    </div>
                    <div class="col-md-6">
                      <label style="color:#FC4343 !important; text-align: center !important;font-weight: bold !important;">Promedio Diario</label>
                      <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                      formControlName="promedioDiasCT3">
                    </div>

                    </div>
                    
                  </form>
                </div>
              </div>
            
            </div>
            <div class="col-md-12">
              <hr style="background-color: #DFA714 !important; height: 2px;">
              <button class="btn btn-warning" (click)="mostrarLecturasCasos(dg,3)" 
              style="font-weight: bold;display: none;" id="btnSelecLecturasCaso3"> 
              <i class="fas fa-search"></i>
               Seleccione los períodos  de facturación a comparar 
              </button>
            </div>
            <form [formGroup]="frm_LecturasEvaluar" class="animated fadeInDown" style="display: none;margin-left: 30px;margin-right: 30px;" id="frmLec">       
            
              <hr style="background-color: #4C9AFD !important; height: 2px;">
              
              <h4 style="color: #4C9AFD;margin-top: 5px;"> 
                <img src="./assets/imagenes/light-bulb.png" height=35>
                Períodos seleccionados  = <a style="color:yellow !important;">{{totalSeleccion}}</a></h4>
              <table class="table small mt-3">
                  <thead class="thead-dark">
                      <tr >
                          <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                          border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                              Período
                          </th>
                          <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                          border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                          Fecha Lectura Ant.
                          </th>
                          <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                          border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                              Fecha Lectura
                          </th>
                          <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                          border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                              Días Facturados
                          </th>
                          <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                          border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                              Consumo
                          </th>
                          <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                          border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                              Consumo no Fact.
                          </th>
                          <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                          border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                          
                            Dif. de consumo
                          </th>
                      </tr>
                  </thead>
                  <tbody  formArrayName="lecturas"
                  style="background-color:#222245; color:white;text-align: center;
                  font-size: 14px;">
                      <tr *ngFor="let item of lecturas.controls; let pointIndex=index" [formGroupName]="pointIndex">
                          <td style="border-bottom: 1px solid #A4FA98;">
                            <input class="form-control" type="text" formControlName="periodo"
                            style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                          </td>
                          <td style="border-bottom: 1px solid #FAFD4F;">
                            <input class="form-control" type="text" formControlName="fechaLecturaAnt"
                              style="text-align: center !important;color: #FAFD4F !important;" readonly="true">
                          </td>
                          <td style="border-bottom: 1px solid #A4FA98;">
                              <input class="form-control" type="text" formControlName="fechaLectura"
                              style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                          </td>
                          <td style="border-bottom: 1px solid #FAFD4F;">
                            <input class="form-control" type="text" formControlName="diasFacturados" name="diasFacturados"
                            style="text-align: center !important;color: #FAFD4F !important;" readonly="true">
                          </td>
                          <td style="border-bottom: 1px solid #A4FA98;">
                            <input class="form-control" type="text" formControlName="consumo" name="consumo"
                            style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                          </td>
                          <td style="border-bottom: 1px solid #FAFD4F;">
                            <input class="form-control" type="text" formControlName="consumoNoFac" name="consumoNoFac"
                            style="text-align: center !important;color: #FAFD4F !important;" readonly="true">
                          </td>
                          <td style="border-bottom: 1px solid #A4FA98;">
                            <input class="form-control" type="text" formControlName="difConsumo" name="difConsumo"
                            style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                            <button class="btn btn-danger btn-sm btn-circle" id="btnEl{{item.value.periodo}}"
                            style="display: none;"
                            (click)="eliminarLectura(pointIndex,item.value.periodo)"><i class="fas fa-trash"></i></button>
                          </td>
                        
                      </tr>
                      
                  </tbody>
                  
              </table>
            </form>
        
        <form [formGroup]="frm_LecturasEvaluarTotales" style="display: none;width: 100% !important;" id="frmLecTotales">
          <div class="row" style="margin-right: 30px;margin-left: 30px;margin-top: 10px;">
            
            <table class="table">
              <thead class="thead-dark">
                <tr>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                    border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center"></th>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                    border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center"></th>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                    border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center"></th>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                          border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center">
                              Días Facturados
                    </th>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                    border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center">
                        Consumo
                    </th>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                    border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center">
                        Consumo no Fact.
                    </th>
                    <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                    border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center">
                    
                       Dif. de consumo
                    </th>
                </tr>
            </thead>
            <tbody style="background-color: #1B1B38 !important;">
              <tr style="background-color: #1B1B38 !important;">
                <td colspan="3"> <h6 style="color:#FF9B00; font-size: 14px;text-align: right;
                  font-weight: bold;"> Totales</h6></td>
                <td>
                  <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                  formControlName="totalDias">
                </td>
                <td>
                  <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                  formControlName="totalConsumo">
                </td>
                <td>
                  <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                  formControlName="totalConsumoNF">
                </td>
                <td>
                  <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                  formControlName="totalDifConsumo">
                </td>
              </tr>
            </tbody>
             
             
              
            </table>
          </div>
         

          <div class="row" style="margin-right: 30px;margin-left: 30px;margin-bottom: 15px;">
            <div class="col-md-12">
              <hr style="background-color: #4C9AFD !important; height: 2px;">
              <h4 style="color: #FB8181">
                <img src="./assets/imagenes/dataResult.png" height=35>
                Resultados obtenidos</h4>
            </div>
              <div class="col-md-4">
                <label style="font-size: 15px !important;color:#FC4343 !important;font-weight: bold;">Consumo ENR_Diario (kwh Diario)</label>
                <input class="form-control" type="text" formControlName="consumoDiarioENR" name="consumoDiarioENR"
                style="text-align: center !important;" readonly="true">
              </div>
              <div class="col-md-4">
                <label style="font-size: 13px !important;color:#FC4343 !important;font-weight: bold;">Consumo Registrado</label>
                <input type="text" class="form-control" formControlName="consumoENRRegistrado" readonly>
               </div>

              <div class="col-md-4">
                <label style="font-size: 15px !important;color:#FC4343 !important;font-weight: bold;">Consumo ENR a facturar (kwh total)</label>
                <input class="form-control" type="text" formControlName="consumoENRFacturar" name="consumoENRFacturar"
                style="text-align: center !important;" readonly="true">
                <input type="hidden" formControlName="numeroCaso">
                
                <input type="hidden" formControlName="idCaso" [(ngModel)]="dg.id">
              </div>
              <div class="col-md-1"></div>
            
          </div>
        </form>
          </div>
        </form>


        <form [formGroup]='frm_Caso4' *ngIf ="datosGenerales.codBase == 'HI'" style="width: 100% !important;">
          <div class="row" style="margin-left: 30px; margin-right: 30px;">
            <div class="col-md-12">
              <hr style="background-color: #DFA714 !important; height: 2px;">
              <button class="btn btn-warning" (click)="mostrarLecturasCasos(dg,4)"> 
              <i class="fas fa-search"></i>
               Seleccione los períodos  de facturación a comparar 
              </button>
            </div>
            <input type="hidden" class="form-control" formControlName="diasCobroCaso4"
            name="diasCobroCaso4" [(ngModel)]="dg.diasCobro" readonly>
            <input type="hidden" formControlName="idCaso" [(ngModel)]="dg.id">
            <div class="col-md-12">
              <form [formGroup]="frm_LecturasEvaluar" class="animated fadeInDown" 
              style="display: none;width: 100% !important;" id="frmLec">       
              
                <hr style="background-color: #4C9AFD !important; height: 2px;">
                
                <h4 style="color: #4C9AFD;margin-top: 5px;"> 
                  <img src="./assets/imagenes/light-bulb.png" height=35>
                  Períodos seleccionados  = <a style="color:yellow !important;">{{totalSeleccion}}</a></h4>
                <table class="table small mt-3">
                    <thead class="thead-dark">
                        <tr >
                            <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                            border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                                Período
                            </th>
                            <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                            border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                            Fecha Lectura Ant.
                            </th>
                            <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                            border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                                Fecha Lectura
                            </th>
                            <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                            border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                                Días Facturados
                            </th>
                            <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                            border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                                Consumo
                            </th>
                            
                        </tr>
                    </thead>
                    <tbody  formArrayName="lecturas"
                    style="background-color:#222245; color:white;text-align: center;
                    font-size: 14px;">
                        <tr *ngFor="let item of lecturas.controls; let pointIndex=index" [formGroupName]="pointIndex">
                            <td style="border-bottom: 1px solid #A4FA98;">
                              
                      <input type="hidden" formControlName="idCaso">
                              <input class="form-control" type="text" formControlName="periodo"
                              style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                            </td>
                            <td style="border-bottom: 1px solid #FAFD4F;">
                              <input class="form-control" type="text" formControlName="fechaLecturaAnt"
                                style="text-align: center !important;color: #FAFD4F !important;" readonly="true">
                            </td>
                            <td style="border-bottom: 1px solid #A4FA98;">
                                <input class="form-control" type="text" formControlName="fechaLectura"
                                style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                            </td>
                            <td style="border-bottom: 1px solid #FAFD4F;">
                              <input class="form-control" type="text" formControlName="diasFacturados" name="diasFacturados"
                              style="text-align: center !important;color: #FAFD4F !important;" readonly="true">
                            </td>
                            <td style="border-bottom: 1px solid #A4FA98;">
                              <input class="form-control" type="text" formControlName="consumo" name="consumo"
                              style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                            
                              <button class="btn btn-danger btn-sm btn-circle" id="btnEl{{item.value.periodo}}"
                              style="display: none;"
                              (click)="eliminarLectura(pointIndex,item.value.periodo)"><i class="fas fa-trash"></i></button>
                          
                            </td>
                            
                          
                        </tr>
                        
                    </tbody>
                    
                </table>
              </form>

              <form [formGroup]="frm_LecturasEvaluarTotales" style="display: none;width: 100% !important;" id="frmLecTotales">
                <div class="row" style="margin-right: 30px;margin-left: 30px;margin-top: 10px;">
                  
                  <table class="table">
                    <thead class="thead-dark">
                      <tr>
                          <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                          border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center"></th>
                          <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                          border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center"></th>
                          <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                          border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center"></th>
                          <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                                border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center">
                                    Días Histórico Total
                          </th>
                          <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                          border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center">
                              Consumo Histórico Total
                          </th>
                          <th style="background-color: #1B1B38;color:#FF9B00;font-size: 13px;
                          border-bottom: 2px solid #FF9B00;font-weight: bold;" class="text-center">
                            Consumo Historico Promedio
                          </th>
                      </tr>
                  </thead>
                  <tbody style="background-color: #1B1B38 !important;">
                    <tr style="background-color: #1B1B38 !important;">
                      <td colspan="3"> <h6 style="color:#FF9B00; font-size: 14px;text-align: right;
                        font-weight: bold;"> Totales</h6></td>
                      <td>
                       
                        <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                        formControlName="totalDias">
                        
                      <input type="hidden" formControlName="idCaso" [(ngModel)]="dg.id">
                      </td>
                      <td>
                        <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                        formControlName="totalConsumo">
                      </td>
                      <td>
                        <input class="form-control" type="text" style="text-align: center !important;" readonly="true"
                        formControlName="consumoHistorioPromedio">
                      </td>
                    </tr>
                  </tbody>
                  </table>


                  <table class="table">
                    <thead class="thead-dark">
                      <tr>
                          <th style="background-color: #1B1B38;color:#FC4343;font-size: 13px;
                          border-bottom: 2px solid #FC4343;font-weight: bold;" class="text-center"></th>
                          <th style="background-color: #1B1B38;color:#FC4343;font-size: 13px;
                          border-bottom: 2px solid #FC4343;font-weight: bold;" class="text-center"></th>
                          <th style="background-color: #1B1B38;color:#FC4343;font-size: 13px;
                          border-bottom: 2px solid #FC4343;font-weight: bold;" class="text-center"></th>
                          <th style="background-color: #1B1B38;color:#FC4343;font-size: 13px;
                                border-bottom: 2px solid #FC4343;font-weight: bold;" class="text-center">
                             Consumo ENR estimado
                          </th>
                          <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                          border-bottom: 2px solid #1FE303;" class="text-center">
                              Consumo Registrado
                          </th>
                          <th style="background-color: #1B1B38;color:#FC4343;font-size: 13px;
                          border-bottom: 2px solid #FC4343;font-weight: bold;" class="text-center">
                            Consumo ENR a Facturar
                          </th>
                      </tr>
                  </thead>
                  <tbody style="background-color: #1B1B38 !important;">
                    <tr style="background-color: #1B1B38 !important;">
                      <td colspan="3"> <h6 style="color:#FC4343; font-size: 14px;text-align: right;
                        font-weight: bold;"> Datos Finales</h6></td>
                      <td>
                        <input type="text" class="form-control" formControlName="consumoENREstimado" readonly>
                      </td>
                      <td>
                        <input type="number" step="0.01" class="form-control" formControlName="consumoENRRegistrado"
                        placeholder="Digíte el consumo registrado" (keyup)="calcularENRCaso4()">
                      </td>
                      <td>
                        <input type="text" class="form-control" formControlName="consumoENRFacturar" readonly>
                        <input type="hidden" formControlName="numeroCaso" >
                      </td>
                    </tr>
                  </tbody>
                  </table>
                  
                </div>
              </form>


              
            </div>
            
          </div>
        </form>



        <form [formGroup]='frm_Caso5' *ngIf ="datosGenerales.codBase == 'EM'" style="width: 100% !important;">
          <input type="hidden" formControlName="idCaso" [(ngModel)]="dg.id">
          <div class="row" style="margin-left: 30px; margin-right: 30px;">
            <div class="col-md-12">
              <hr style="background-color: #A16EFF !important; height: 2px;">
            </div>
            <input type="hidden" class="form-control" formControlName="diasCobroCaso5"
            name="diasCobroCaso5" [(ngModel)]="dg.diasCobro" readonly>
            <div class="col-md-3">
              <label>Porcentaje Exactitud OT</label>
              <input type="number" step="0.01" class="form-control"  (keyup)="calcularDiferenciaExactitud()"
              autocomplete="off" placeholder="Porcentaje Exactitud OT" 
              formControlName="porcentajeExactitudOT" name="porcentajeExactitudOT">
             
            </div>
            <div class="col-md-3">
              <label>Porcentaje exactitud Base</label>
              <input type="text" class="form-control"
               formControlName="porcentajeExactitudBase" name="porcentajeExactitudBase" readonly>
            </div>
              
            <div class="col-md-3">
              <label>Diferencia Exactitud (%)</label>
                  <input type="text" class="form-control" formControlName="diferenciaExactitud"
                   name="diferenciaExactitud" placeholder="Diferencia Exactitud (%)"  readonly>
            </div>
            <div class="col-md-3">
              <label>Consumo Registrado</label>
              <input type="number" step="0.01" class="form-control" formControlName="consumoENRRegistrado" 
              placeholder="Consumo Registrado" (keyup)="totalizarDato()">
             </div>


            <div class="col-md-12">
              <hr style="background-color: #DFA714 !important; height: 2px;">
              <button class="btn btn-warning" (click)="mostrarLecturasCasos(dg,5)" 
              style="font-weight: bold;display: none;" id="btnSelecLecturasCaso5"> 
              <i class="fas fa-search"></i>
               Seleccione los períodos  de facturación a comparar 
              </button>
            </div>

            <div class="col-md-12">
              <form [formGroup]="frm_LecturasEvaluar" class="animated fadeInDown" 
              style="display: none;width: 100% !important;" id="frmLec">       
              
                <hr style="background-color: #4C9AFD !important; height: 2px;">
                
                <h4 style="color: #4C9AFD;margin-top: 5px;"> 
                  <img src="./assets/imagenes/light-bulb.png" height=35>
                  Períodos seleccionados  = <a style="color:yellow !important;">{{totalSeleccion}}</a></h4>
                <table class="table small mt-3">
                    <thead class="thead-dark">
                        <tr >
                            <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                            border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                                Período
                            </th>
                            <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                            border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                            Fecha Lectura Ant.
                            </th>
                            <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                            border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                                Fecha Lectura
                            </th>
                            <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                            border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                                Días Facturados
                            </th>
                            <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                            border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                                Consumo
                            </th>
                            <th style="background-color: #1B1B38;color:yellow;font-size: 13px;
                            border-bottom: 2px solid yellow;font-weight: bold;" class="text-center">
                                Consumo fuera del rango de norma
                            </th>
                            <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                            border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                                Consumo Correcto
                            </th>
                        </tr>
                    </thead>
                    <tbody  formArrayName="lecturas"
                    style="background-color:#222245; color:white;text-align: center;
                    font-size: 14px;">
                        <tr *ngFor="let item of lecturas.controls; let pointIndex=index" [formGroupName]="pointIndex">
                            <td style="border-bottom: 1px solid #A4FA98;">
                              <input type="hidden" formControlName="idCaso">
                              <input class="form-control" type="text" formControlName="periodo"
                              style="text-align: center !important;color: #A4FA98 !important;" readonly="true">

                             
                            </td>
                            <td style="border-bottom: 1px solid #FAFD4F;">
                              <input class="form-control" type="text" formControlName="fechaLecturaAnt"
                                style="text-align: center !important;color: #FAFD4F !important;" readonly="true">
                            </td>
                            <td style="border-bottom: 1px solid #A4FA98;">
                                <input class="form-control" type="text" formControlName="fechaLectura"
                                style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                            </td>
                            <td style="border-bottom: 1px solid #FAFD4F;">
                              <input class="form-control" type="text" formControlName="diasFacturados" name="diasFacturados"
                              style="text-align: center !important;color: #FAFD4F !important;" readonly="true">
                            </td>
                            <td style="border-bottom: 1px solid #A4FA98;">
                              <input class="form-control" type="text" formControlName="consumo" name="consumo"
                              style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                             
                              <button class="btn btn-danger btn-sm btn-circle" id="btnEl{{item.value.periodo}}"
                              style="display: none;"
                              (click)="eliminarLectura(pointIndex,item.value.periodo)"><i class="fas fa-trash"></i></button>
                          
                            </td>
                            <td style="border-bottom: 1px solid #FAFD4F;">
                              <input class="form-control" type="text" formControlName="consumoFuera" name="consumoFuera"
                              style="text-align: center !important;color: #FAFD4F !important;" readonly="true">
                            </td>
                            <td style="border-bottom: 1px solid #FAFD4F;">
                              <input class="form-control" type="text" formControlName="consumoCorrecto" name="consumoCorrecto"
                              style="text-align: center !important;color: #FAFD4F !important;" readonly="true">
                            </td>
                          
                        </tr>
                        
                    </tbody>
                    
                </table>
              </form>

              <form [formGroup]="frm_LecturasEvaluarTotales" style="display: none;width: 100% !important;" id="frmLecTotales">
                <div class="row"> 
                  <table class="table">
                    <thead class="thead-dark">
                      <tr>
                          
                          <th style="background-color: #1B1B38;color:#FC4343;font-size: 13px;
                                border-bottom: 2px solid #FC4343;font-weight: bold;" class="text-center">
                             Consumo Facturado
                          </th>
                          <th style="background-color: #1B1B38;color:#FC4343;font-size: 13px;
                                border-bottom: 2px solid #FC4343;font-weight: bold;" class="text-center">
                             Consumo Fuera de rango
                          </th>
                          <th style="background-color: #1B1B38;color:#FC4343;font-size: 13px;
                          border-bottom: 2px solid #FC4343;" class="text-center">
                              Consumo correcto debió facturarse
                          </th>
                          <th style="background-color: #1B1B38;color:#FC4343;font-size: 13px;
                          border-bottom: 2px solid #FC4343;font-weight: bold;" class="text-center">
                            Consumo Registrado
                          </th>
                          <th style="background-color: #1B1B38;color:#FC4343;font-size: 13px;
                          border-bottom: 2px solid #FC4343;font-weight: bold;" class="text-center">
                            Consumo ENR a Facturar
                          </th>
                      </tr>
                  </thead>
                  <tbody style="background-color: #1B1B38 !important;">
                    <tr style="background-color: #1B1B38 !important;">
                      <td>
                        <input type="text" class="form-control" formControlName="totalConsumo" readonly>
                      </td>
                      <td>
                        <input type="text" class="form-control" formControlName="consumoFuera" readonly>
                      </td>
                      <td>
                        <input type="text" class="form-control" formControlName="consumoDebioFacturar" readonly>
                      </td>
                      <td>
                        <input type="text" class="form-control" formControlName="consumoENRRegistrado" readonly>
                      </td>
                      <td>
                        <input type="text" class="form-control" formControlName="consumoENRFacturar" readonly>
                        <input type="hidden" formControlName="numeroCaso">
                        <input type="hidden" formControlName="idCaso" [(ngModel)]="dg.id">
                      </td>
                    </tr>
                  </tbody>
                  </table>
                </div>
              </form>


              
            </div>
          </div>
        </form>
        <div class="row" style="margin-left: 30px; margin-right: 30px;width: 100% !important;
        display: none;"
        id="btnFacturacion">
          
          <div class="col-md-12">
            <button class="btn btn-success pull-right"
          style="float: right !important;"  (click)="verTarifas(datosGenerales.tarifa)"><i class="fas fa-calculator"></i> Cálculos de facturación</button>
          </div>
        </div>
      

        <form [formGroup]="frm_tarifas" style="width: 98% !important;">
          <div id="loading" class="animated flipInX" style="text-align: center !important; align-items: center !important;display: none;">
            <div class="lds-spinner">
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
            </div>
            <div style="text-align: center;font-size: 23px;color:#02FF20;font-weight: bold;">
              <img src="./assets/imagenes/calc.png" height=35
              style="margin-bottom:10px !important">
              Calculando Datos
             </div>
          </div>

          <div id="divTarifas" class="row mt-2 animated fadeInDown" style="display:none;
           width: 97% !important;margin-left: 30px;margin-right: 30px;">
           
    
              <input type="hidden" [(ngModel)]="dg.fechaIn" formControlName="fechaInicio">
            
              <input type="hidden" [(ngModel)]="dg.fechaFin" formControlName="fechaFin">
              <input type="hidden" [(ngModel)]="dg.id" formControlName="numeroCaso">
           
           <div class="col-lg-12">
            <hr style="background-color: yellow !important; height: 2px;">
            <h4 class="text-center tbTarifa"> Dias a Cobrar (Fecha incluye dias de vigencia de tarifa) </h4>
            <table id="" class="table small" style="width: 100%;">
              <thead class="thead-dark" >
                <tr >
                  <th *ngFor="let tar  of tarifasFechas" class="text-center tarifa1enc">{{tar.fechasTarifa}}</th>
                  <th class="text-center tarifa3enc">Total</th>
                </tr>
                
              </thead>
              <tbody style="color:white;text-align: center;font-size: 11px;">
                <tr>
                  <td *ngFor="let tar  of tarifasFechas" class="text-center tarifa2enc">{{tar.dias}}</td>
                  <td *ngFor="let tar  of tarifasFechasTotal" class="text-center tarifa3">{{tar.dias}}</td>
                </tr>
              </tbody>
          </table>
           </div>


           <div class="col-lg-12">
            <h4 class="text-center tbTarifa"> Consumo Estimado </h4>
            <table id="" class="table small" style="width: 100%;">
              <thead class="thead-dark">
                <tr >
                  <th *ngFor="let consumo  of consumoEstimado" class="text-center tarifa1enc">{{consumo.fechasTarifa}}</th>
                  <th class="text-center tarifa3enc">Total</th>
                </tr>
                
              </thead>
              <tbody style="color:white;text-align: center;font-size: 11px;">
                <tr>
                  <td *ngFor="let consumo  of consumoEstimado" class="text-center tarifa2enc">{{consumo.consumo}}</td>
                  <td *ngFor="let consumo  of consumoEstimadoTotal" class="text-center tarifa3">{{consumo.consumo}}</td>
                </tr>
              </tbody>
          </table>
           </div>

           <div class="col-lg-12">
            <h4 class="text-center tbTarifa"> Consumo Registrado </h4>
            <table id="" class="table small" style="width: 100%;">
              <thead class="thead-dark" >
                <tr >
                  <th *ngFor="let consumo  of consumoRegistrado" class="text-center tarifa1enc">{{consumo.fechasTarifa}}</th>
                  <th class="text-center tarifa3enc">Total</th>
                </tr>
                
              </thead>
              <tbody style="color:white;text-align: center;font-size: 11px;">
                <tr>
                  <td *ngFor="let consumo  of consumoRegistrado" class="text-center tarifa2enc">{{consumo.consumo}}</td>
                  <td *ngFor="let consumo  of consumoRegistradoTotal" class="text-center tarifa3">{{consumo.consumo}}</td>
                </tr>
              </tbody>
          </table>
           </div>


           <div class="col-lg-12">
            <h4 class="text-center tbTarifa"> Consumo ENR </h4>
            <table id="" class="table small" style="width: 100%;">
              <thead class="thead-dark" >
                <tr >
                  <th *ngFor="let consumo  of consumoENR" class="text-center tarifa1enc">{{consumo.fechasTarifa}}</th>
                  <th class="text-center tarifa3enc">Total</th>
                </tr>
                
              </thead>
              <tbody style=" color:white;text-align: center;font-size: 11px;">
                <tr>
                  <td *ngFor="let consumo  of consumoENR" class="text-center tarifa2enc" rowspan="2">{{consumo.consumo}}</td>
                  <td *ngFor="let consumo  of consumoENRTotal" class="text-center tarifa3">{{consumo.consumo}}</td>
                </tr>
              </tbody>
          </table>
           </div>

           <div *ngIf="datosGenerales.tarifa == '1R'" style="width: 100% !important;">
            <div class="col-lg-12">
              <h4 class="text-center tbTarifa"> Consumo  KWH ENR	</h4>
              <table id="" class="table small" style="width: 100%;">
                <thead class="thead-dark" >
                  <tr >
                    <th class="text-center tarifa1enc"></th>
                    <th *ngFor="let consumo  of consumoENR" class="text-center tarifa1enc">{{consumo.fechasTarifa}}</th>
                    <th class="text-center tarifa3enc">Total</th>
                  </tr>
                  
                </thead>
                <tbody style=" color:white;text-align: center;font-size: 11px;">
                  <tr>
                   <td class="text-center tarifa4">Bloque 0 a 99 kwh</td>
                   <td *ngFor="let consumo  of consumoENR1erBloque" class="text-center tarifa4M">
                     {{consumo.consumo}}</td>
                     <td *ngFor="let consumo  of consumoENR1erBloqueTotal" class="text-center tarifa4MF">
                      {{consumo.consumo}}</td>
                  </tr>
  
                  <tr>
                    <td class="text-center tarifa4">Bloque 100 a 199 kwh</td>
                    <td *ngFor="let consumo  of consumoENR2doBloque" class="text-center tarifa4M">
                      {{consumo.consumo}}</td>
                      <td *ngFor="let consumo  of consumoENR2doBloqueTotal" class="text-center tarifa4MF">
                        {{consumo.consumo}}</td>
                  </tr>
  
                  <tr>
                    <td class="text-center tarifa4FS">Bloque mayor a 200 kwh</td>
                    <td *ngFor="let consumo  of consumoENR3erBloque" class="text-center tarifa4MS">
                      {{consumo.consumo}}</td>
                      <td *ngFor="let consumo  of consumoENR3erBloqueTotal" class="text-center tarifa4MFS">
                        {{consumo.consumo}}</td>
                  </tr>
                 
                  <tr>
                    <td class="text-center tarifaTenc" >Totales</td>
                    <td *ngFor="let consumo  of consumoENRTotalGlobalFechas" class="text-center tarifa4MFF">
                      {{consumo.consumo}}</td>
                      <td *ngFor="let consumo  of consumoENRTotalGlobal" class="text-center tarifa4MFT">
                        {{consumo.consumo}}</td>
                  </tr>
                   
                 
                </tbody>
            </table>
             </div>
  
  
             <div class="col-lg-12">
              <h4 class="text-center tbTarifa"> Consumo  Monto Energía ENR	</h4>
              <table id="" class="table small" style="width: 100%;">
                <thead class="thead-dark" >
                  <tr >
                    <th class="text-center tarifa1enc"></th>
                    <th *ngFor="let consumo  of consumoENR" class="text-center tarifa1enc">{{consumo.fechasTarifa}}</th>
                    <th class="text-center tarifa3enc">Total</th>
                  </tr>
                  
                </thead>
                <tbody style=" color:white;text-align: center;font-size: 11px;">
                  <tr>
                   <td class="text-center tarifa4">Energía 1er bloque</td>
                   <td *ngFor="let consumo  of consumoENR1erBloqueEnergia" class="text-center tarifa4M">
                     {{consumo.consumo}}</td>
                     <td *ngFor="let consumo  of consumoENR1erBloqueTotalEnergia" class="text-center tarifa4MF">
                      {{consumo.consumo}}</td>
                  </tr>
  
                  <tr>
                    <td class="text-center tarifa4">Energía 2do bloque</td>
                    <td *ngFor="let consumo  of consumoENR2doBloqueEnergia" class="text-center tarifa4M">
                      {{consumo.consumo}}</td>
                      <td *ngFor="let consumo  of consumoENR2doBloqueTotalEnergia" class="text-center tarifa4MF">
                        {{consumo.consumo}}</td>
                  </tr>
  
                  <tr>
                    <td class="text-center tarifa4FS">Energía 3er bloque</td>
                    <td *ngFor="let consumo  of consumoENR3erBloqueEnergia" class="text-center tarifa4MS">
                      {{consumo.consumo}}</td>
                      <td *ngFor="let consumo  of consumoENR3erBloqueTotalEnergia" class="text-center tarifa4MFS">
                        {{consumo.consumo}}</td>
                  </tr>
                 
                  <tr>
                    <td class="text-center tarifaTenc" >Totales</td>
                    <td *ngFor="let consumo  of consumoENRTotalGlobalFechasEnergia" class="text-center tarifa4MFF">
                      {{consumo.consumo}}</td>
                      <td *ngFor="let consumo  of consumoENRTotalGlobalEnergia" class="text-center tarifa4MFT">
                        {{consumo.consumo}}</td>
                  </tr>
                   
                 
                </tbody>
            </table>
             </div>
  
             <div class="col-lg-12">  
              <h4 class="text-center tbTarifa"> Consumo  Monto Distribución ENR	</h4>
              <table id="" class="table small" style="width: 100%;">
                <thead class="thead-dark" >
                  <tr >
                    <th class="text-center tarifa1enc"></th>
                    <th *ngFor="let consumo  of consumoENR" class="text-center tarifa1enc">{{consumo.fechasTarifa}}</th>
                    <th class="text-center tarifa3enc">Total</th>
                  </tr>
                  
                </thead>
                <tbody style=" color:white;text-align: center;font-size: 11px;">
                  <tr>
                   <td class="text-center tarifa4">Distribución 1er bloque</td>
                   <td *ngFor="let consumo  of consumoENR1erBloqueDistribucion" class="text-center tarifa4M">
                     {{consumo.consumo}}</td>
                     <td *ngFor="let consumo  of consumoENR1erBloqueTotalDistribucion" class="text-center tarifa4MF">
                      {{consumo.consumo}}</td>
                  </tr>
  
                  <tr>
                    <td class="text-center tarifa4">Distribución 2do bloque</td>
                    <td *ngFor="let consumo  of consumoENR2doBloqueDistribucion" class="text-center tarifa4M">
                      {{consumo.consumo}}</td>
                      <td *ngFor="let consumo  of consumoENR2doBloqueTotalDistribucion" class="text-center tarifa4MF">
                        {{consumo.consumo}}</td>
                  </tr>
  
                  <tr>
                    <td class="text-center tarifa4FS">Distribución 3er bloque</td>
                    <td *ngFor="let consumo  of consumoENR3erBloqueDistribucion" class="text-center tarifa4MS">
                      {{consumo.consumo}}</td>
                      <td *ngFor="let consumo  of consumoENR3erBloqueTotalDistribucion" class="text-center tarifa4MFS">
                        {{consumo.consumo}}</td>
                  </tr>
                 
                  <tr>
                    <td class="text-center tarifaTenc" >Totales</td>
                    <td *ngFor="let consumo  of consumoENRTotalGlobalFechasDistribucion" class="text-center tarifa4MFF">
                      {{consumo.consumo}}</td>
                      <td *ngFor="let consumo  of consumoENRTotalGlobalDistribucion" class="text-center tarifa4MFT">
                        {{consumo.consumo}}</td>
                  </tr>
                   
                 
                </tbody>
            </table>
             </div>
           </div>


           <div *ngIf="datosGenerales.tarifa == '1G'" style="width: 100% !important;">
            <div class="col-lg-12">
              <h4 class="text-center tbTarifa"> Consumo  Monto Energía ENR	</h4>
              <table id="" class="table small" style="width: 100%;">
                <thead class="thead-dark" >
                  <tr >
                    <th class="text-center tarifa1enc"></th>
                    <th *ngFor="let consumo  of consumoENR" class="text-center tarifa1enc">{{consumo.fechasTarifa}}</th>
                    <th class="text-center tarifa3enc">Total</th>
                  </tr>
                  
                </thead>
                <tbody style=" color:white;text-align: center;font-size: 11px;">
                  <tr>
                   <td class="text-center tarifa4">Energía</td>
                   <td *ngFor="let consumo  of consumoENR3erBloqueTotalEnergia" class="text-center tarifa4M">
                     {{consumo.consumo}}</td>
                     <td *ngFor="let consumo  of consumoENR1erBloqueTotalEnergia" class="text-center tarifa4MF">
                      {{consumo.consumo}}</td>
                  </tr>
                </tbody>
            </table>
             </div>
  
             <div class="col-lg-12">  
              <h4 class="text-center tbTarifa"> Consumo  Monto Distribución ENR	</h4>
              <table id="" class="table small" style="width: 100%;">
                <thead class="thead-dark" >
                  <tr >
                    <th class="text-center tarifa1enc"></th>
                    <th *ngFor="let consumo  of consumoENR" class="text-center tarifa1enc">{{consumo.fechasTarifa}}</th>
                    <th class="text-center tarifa3enc">Total</th>
                  </tr>
                  
                </thead>
                <tbody style=" color:white;text-align: center;font-size: 11px;">
                  <tr>
                   <td class="text-center tarifa4">Distribución</td>
                   <td *ngFor="let consumo  of consumoENRTotalGlobalFechasDistribucion" class="text-center tarifa4M">
                     {{consumo.consumo}}</td>
                     <td *ngFor="let consumo  of consumoENR1erBloqueTotalDistribucion" class="text-center tarifa4MF">
                      {{consumo.consumo}}</td>
                  </tr>
                </tbody>
            </table>
             </div>
           </div>

           <form [formGroup]="cobroMedidor" style="width: 100% !important;margin-top: 10px;">
           
              <hr style="background-color: #02FF20 !important; height: 2px;">
              <h5 style="color:#02FF20; font-weight: bold;font-size: 15px;">
                Llenar este campo únicamente si se cobrará cambio de medidor</h5>
               <div class="row">
                <div class="col-md-6">
                  <label><i class="fas fa-dollar-sign"></i> Cantidad a cobrar</label>
                  <input type="number" step="0.01" class="form-control" formControlName="cantidadCobrar"
                  placeholder="Cobro por mediddor">
                </div>
  
                <div class="col-md-6">
                  <label><i class="fas fa-comments"></i> Datos adicionales al cálculo</label>
                  <textarea rows="4"  class="form-control" formControlName="datosCalculo"
                  placeholder="Datos adicionales al cálculo"></textarea>
                </div>
               </div>
                 
                
              
              <input type="hidden" [(ngModel)]="dg.id" formControlName="idCaso">
           
            
           </form>
          <div class="col-lg-12">
            <hr style="background-color: #8655EA !important; height: 2px;">
           <button class="btn btn-lg btn-block btn btn-default save" 
           style="font-size: 15px !important" data-toggle="modal" 
           data-target="#guardarDatosFinalesConfirm">
            <i class="fas fa-save"></i> Guardar todos los datos
          </button>
          
          </div>


          
           

          </div>
        </form>

     

        </div>
      

  </div>
</div>


<!--Inicio de la gestión de los repositorios-->
<div class="row animated fadeInLeft" style="margin-left: 30px;margin-right: 30px;
background-color: #323259;" id="titleGlobal">
  <div class="center" style="margin: auto;">
    <h3 style="color: #9AFB4D;">
        <img class="img-profile" src="./assets/imagenes/folder.png"
        style="margin-bottom: 5px;margin-top: 5px;" height=45>
        Repositorio de Casos de ENR
    </h3>
  </div>
</div>
<br><br>

    <ul class="animated fadeInRight nav nav-tabs" id="myTab" role="tablist" 
    style="margin-right: 30px;
    margin-left: 30px;">
      <li class="nav-item">
        <a class="nav-link active"  data-toggle="tab" href="#ingresados" role="tab" (click)="getRepositorioIng()"
        aria-controls="home" aria-selected="true" style="color:white;background-color: #1B1B38;">
        <i class="fas fa-save"></i>
        Ingresado
         </a>
      </li>
      <li class="nav-item" style="border-bottom:1px solid white;">
        <a class="nav-link"  data-toggle="tab" href="#calculados" role="tab" (click)="getRepositorioCalc()"
        aria-controls="profile" aria-selected="false" style="color:white;background-color: #1B1B38;">
         <i class="fas fa-calculator"></i>
            Calculado
        </a>
      </li>
      <li class="nav-item" style="border-bottom:1px solid white;">
        <a class="nav-link"  data-toggle="tab" href="#notificados" role="tab" (click)="getRepositorioNoti()"
        aria-controls="profile" aria-selected="false" style="color:white;background-color: #1B1B38;">
         <i class="fas fa-bell"></i>
            Notificado
        </a>
      </li>
    </ul>

    <div class="tab-content" id="myTabContent" style="background-color: #323259;margin-right: 30px;
    margin-left: 30px;border: 1px solid white;">
        <div class="tab-pane fade show active" id="ingresados" role="tabpanel" aria-labelledby="">
            <div class="row animated flipInX">
                <div class="col-lg-2"></div>
                    <div class="col-lg-8" style="background-color: #1B1B38;color: white;
                    text-align: center;font-size: 25px;color:#4DFBE6;font-weight: bold;">
                      <img class="img-profile" src="./assets/imagenes/homework.png"  height=35
                      style="margin-bottom: 5px;">
                      Casos Ingresados (Pendientes de Cálculo)
                    </div>                   
                <div class="col-lg-2"></div>

            </div>
            <div class="row mt-5 animated fadeInLeft">
                <div class="col-lg-1"></div>
                <div class="col-lg-10">
                    <table  id="tbl_Ingresados" class="table small mt-5" style="width: 100%;">
                        <thead class="thead-dark">
                          <tr>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">N° Caso</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">N° Suministro</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Cod. Tipo ENR</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Cod. Metodología ENR</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Dias de Cobro</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Fecha de Creación</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Acciones</th>
                        </tr>
                        </thead>
                        <tbody style="background-color:#323259; color:white;text-align: center;font-size: 11px;">
                            <tr *ngFor="let rep  of repositorioIng"
                            [ngClass]="{adjuntos: rep.adjuntos > 0}">
                               <td>{{rep.caso}}</td>
                               <td>{{rep.nis}}</td>
                               <td>{{rep.codigoENR}}</td>
                               <td>{{rep.metodologiaENR}}</td>
                               <td>{{rep.diasCobrar}}</td>
                               <td>{{rep.fechaCreacion}}</td>
                               <td style="width: 20% !important;">
                                <button class="btn btn-default btn-circle btn1"
                                id="btnD{{rep.caso}}"
                                data-toggle="modal"  data-target="#datosCaso"
                                (click)="datosEditar(rep)" title="Editar caso">
                                    <i class="fas fa-edit"></i>
                                 </button>
                                         &nbsp;
                                 <button class="btn btn-default btn-circle btn2"
                                 (click)="calcularCaso(rep, rep.caso)" title="Calcular caso">
                                     <i class="fas fa-calculator"></i>
                                 </button>

                                 &nbsp;
                                 <button type="button" class="btn btn-danger btn-circle" 
                                 data-toggle="modal"  data-target="#mdEliminarCaso" 
                                 (click)="eliminarCaso(rep.caso)" title="Eliminar caso">
                                   <i class="fas fa-trash"></i> 
                                 </button>
                               </td>
                            </tr>
                        </tbody>
                    </table><br><br>
                </div>
                <div class="col-lg-1"></div>
            </div>         
        </div>
        <div class="tab-pane" id="calculados" role="tabpanel" aria-labelledby="">
            <div class="row animated flipInX">
                <div class="col-lg-2"></div>
                    <div class="col-lg-8" style="background-color: #1B1B38;color: white;
                    text-align: center;font-size: 25px;color:#4DFBE6;font-weight: bold;">
                      <img class="img-profile" src="./assets/imagenes/moneyIn.png"  height=35
                      style="margin-bottom: 5px;">
                      Casos Calculados (Pendientes de Notificación)
                    </div>                   
                <div class="col-lg-2"></div>
            </div>

            <div class="row mt-5 animated fadeInLeft">
                <div class="col-lg-1"></div>
                <div class="col-lg-10">
                    <table  id="tbl_Calculados" class="table small mt-5" style="width: 100%;">
                        <thead class="thead-dark">
                          <tr>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">N° Caso</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">N° Suministro</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Cod. Tipo ENR</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Cod. Metodología ENR</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Dias de Cobro</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Fecha de Creación</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Acciones</th>
                        </tr>
                        </thead>
                        <tbody style="background-color:#323259; color:white;text-align: center;font-size: 11px;">
                            <tr *ngFor="let rep  of repositorioCalc"
                            [ngClass]="{adjuntos: rep.adjuntos > 0}">
                               <td>{{rep.caso}}</td>
                               <td>{{rep.nis}}</td>
                               <td>{{rep.codigoENR}}</td>
                               <td>{{rep.metodologiaENR}}</td>
                               <td>{{rep.diasCobrar}}</td>
                               <td>{{rep.fechaCreacion}}</td>
                               <td style="width: 20% !important;">
                                <button class="btn btn-default btn-circle btn1"
                                data-toggle="modal"  data-target="#datosCasoCalc" (click)="datosEditar(rep)"
                                title="Ver detalles del caso">
                                    <i class="fas fa-edit"></i>
                                 </button>
                                         &nbsp;
                                 <button class="btn btn-default btn-circle btn2" title="Generar reporte"
                                  data-toggle="modal"  data-target="#datosImprimir" (click)="datosImprimir(rep)">
                                     <i class="fas fa-bell"></i>
                                 </button>
                                 &nbsp;
                                 <button type="button" class="btn btn-danger btn-circle"  title="Eliminar caso"
                                 (click)="eliminarCaso(rep.caso)">
                                   <i class="fas fa-trash"></i> 
                                 </button>
                                </td>
                            </tr>
                        </tbody>
                    </table><br><br>
                </div>
                <div class="col-lg-1"></div>
            </div> 

        </div>

        <div class="tab-pane" id="notificados" role="tabpanel" aria-labelledby="">
            <div class="row animated flipInX">
                <div class="col-lg-2"></div>
                    <div class="col-lg-8" style="background-color: #1B1B38;color: white;
                    text-align: center;font-size: 25px;color:#4DFBE6;font-weight: bold;">
                      <img class="img-profile" src="./assets/imagenes/bell.png"  height=35
                      style="margin-bottom: 5px;">
                      Casos Notificados
                    </div>                   
                <div class="col-lg-2"></div>
            </div>

            <div class="row mt-5 animated fadeInLeft">
                <div class="col-lg-1"></div>
                <div class="col-lg-10">
                    <table  id="tbl_Notificados" class="table small mt-5" style="width: 100%;">
                        <thead class="thead-dark">
                          <tr>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">N° Caso</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">N° Suministro</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Cod. Tipo ENR</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Cod. Metodología ENR</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Dias de Cobro</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Fecha de Creación</th>
                            <th style="background-color:#1B1B38; color:#A16EFF;font-size: 11px;" class="text-center">Acciones</th>
                          </tr>
                        </thead>
                        <tbody style="background-color:#323259; color:white;text-align: center;font-size: 11px;">
                            <tr *ngFor="let rep  of repositorioNoti"
                            [ngClass]="{adjuntos: rep.adjuntos > 0}">
                               <td>{{rep.caso}}</td>
                               <td>{{rep.nis}}</td>
                               <td>{{rep.codigoENR}}</td>
                               <td>{{rep.metodologiaENR}}</td>
                               <td>{{rep.diasCobrar}}</td>
                               <td>{{rep.fechaCreacion}}</td>
                               <td style="width: 20% !important;">
                                <button class="btn btn-default btn-circle btn1" title="Ver detalles del caso"
                                data-toggle="modal"  data-target="#datosCasoNoti" (click)="datosEditar(rep)">
                                    <i class="fas fa-edit"></i>
                                 </button>
                                 &nbsp;
                                 <button type="button" class="btn btn-info btn-circle" 
                                 (click)="verPDFImpreso(rep.caso)" title="Ver reporte">
                                   <i class="fas fa-print"></i> 
                                 </button>
                                 &nbsp;
                                 <button type="button" class="btn btn-danger btn-circle"  title="Eliminar caso"
                                 (click)="eliminarCaso(rep.caso)">
                                   <i class="fas fa-trash"></i> 
                                 </button>
                                 
                            </tr>
                        </tbody>
                    </table><br><br>
                </div>
                <div class="col-lg-1"></div>
            </div> 

        </div>
    </div>



    
    <!--Modal para ver detalle de adjunto-->
<div class="modal animated fadeInDown" id="verAdjuntosOrden" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog  mw-100 w-75">
    <div class="modal-content">
      <div class="modal-header">
      </div>
      <div class="modal-body">
        
        <div *ngIf="adjuntosOrdenesVer">
            <div *ngIf="extension === 'pdf'">
              <iframe [src]="adjuntoVer" width="100%" height="450px"></iframe>
            </div>
            <div *ngIf="extension === 'jpg' ">
              <img [src]="adjuntoVer" width="650px" height="450px"
              style="margin-left: 20%;"/>
            </div>
  
            <div *ngIf="extension === 'png' ">
              <img [src]="adjuntoVer" width="650px" height="450px"
              style="margin-left: 20%;"/>
            </div>
            <div *ngIf="extension === 'txt' ">
              <h2 style="color:yellow;text-align: center;">El formato .txt solo puede ser descargado</h2>
            </div>
          </div>
        
      
     </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal"
          data-toggle="modal" data-target="#datosCaso">
          <i class="fas fa-times-circle"></i>  Cerrar
        </button>          
      </div>
    </div>
  </div>
</div>


<!--Modal de confirmación para eliminar adjunto-->
<div class="modal animated fadeInLeft" id="confirmarEliminarAdjunto" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content modal-lg">
        <div class="modal-header">
          <h5 class="title" style="color:#0CD902 !important;">
            <img class="img-profile" src="./assets/imagenes/confirm.png" width=35 height=35>
            Confirmación
          </h5>
          
        </div>
        <div class="modal-body">
          <form [formGroup]='frm_ArchivoEliminar'>
            
            <input type="hidden" class="form-control"
            formControlName="idEliminar" name="idEliminar"> 
            <input type="hidden" class="form-control"
            formControlName="rutaEliminar" name="rutaEliminar"> 
        </form>    
  
          <h6 style="text-align: center;color: #67E1E1;">¿Desea eliminar el archivo 
            <a style="color:yellow">"{{archivoEliminar.ruta}}"</a>
            asociado al caso <a style="color:yellow">"{{archivoEliminar.caso}}"</a> ?</h6>
          <h5 style="text-align: center;color: #FC0505;">¡Se borrará de todo el repositorio de archivos!</h5>
  
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-info" data-dismiss="modal" 
          data-toggle="modal" data-target="#datosCaso">
            <i class="fas fa-times-circle"></i>  No!
          </button>
          <button type="button" class="btn btn-danger" data-dismiss="modal"
          (click)="eliminarArchivo(archivoEliminar)"
          data-toggle="modal" data-target="#datosCaso">
            <i class="fas fa-thumbs-up"></i>  Si, eliminar!
          </button>
          
          
        </div>
      </div>
    </div>
</div>

<!--Modal para modificación de datos de caso ENR-->

<div class="modal animated fadeInDown" id="datosCaso" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog mw-100 w-75" >
    <div class="modal-content">
      <div class="modal-header" >
        
        <div class="row" style="margin-left: 30px;">
          <ul class="nav nav-tabs" id="myTab" role="tablist" >
          <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#datosNIS" role="tab"
            aria-controls="home" aria-selected="true" style="color:#FB51EE;background-color: #1B1B38;">
            <i class="fas fa-cogs"></i>
            Datos del NIS
            </a>
          </li>
          <li class="nav-item" style="border-bottom:1px solid white;">
            <a class="nav-link"  data-toggle="tab" href="#ordenesNIS" role="tab"
            aria-controls="profile" aria-selected="false" style="color:#51F749;background-color: #1B1B38;">
            <i class="fas fa-paperclip"></i>
                Órdenes tec. del NIS
            </a>
          </li>
          <li class="nav-item" style="border-bottom:1px solid white;">
            <a class="nav-link"  data-toggle="tab" href="#datosENR" role="tab"
            aria-controls="profile" aria-selected="false" style="color:#49F7DD;background-color: #1B1B38;">
            <i class="fas fa-money-bill-alt"></i>
                Datos de ENR
            </a>
          </li>
          <li class="nav-item" style="border-bottom:1px solid white;">
            <a class="nav-link"  data-toggle="tab" href="#docAdjuntos" role="tab"
            aria-controls="profile" aria-selected="false" style="color:#D1D104;background-color: #1B1B38;">
            <i class="fas fa-file"></i>
                Adjuntos
            </a>
          </li>
        </ul>
        </div>
        <h6 class="title" style="color:#B18AFF !important;margin-right: 40px;">
          Caso N°: <a style="color: #0CD902;">{{ordenNumeroG.caso}}</a><br>
          Usuario creacion: <a style="color: #0CD902;">{{ordenNumeroG.usuarioCreacion}}</a> 
        </h6>
      </div>
      <div class="modal-body" style="max-height: calc(100vh - 200px);
      overflow-y: auto;overflow-x: hidden;">
        
        <div class="tab-content" id="myTabContent" style="background-color: #323259;margin-right: 30px;
        margin-left: 30px;border: 1px solid white;
       max-height: calc(100vh - 200px);
      overflow-y: auto;overflow-x: hidden;">
            <div class="tab-pane fade show active" id="datosNIS" role="tabpanel" aria-labelledby="">
              <div class="row animated fadeInRight" *ngFor="let dat  of datos">
                
                <form [formGroup]='frm_DatosNIS'>
                  <div class="row" style="margin-left: 30px;margin-right: 30px;margin-top: 30px;margin-bottom: 30px;" >
                    <div class="col-lg-12">
                      <hr style="background-color: #FB51EE !important;height: 2px;">
              
                      <h4 style="color: #FB51EE;">
                          <img class="img-profile" src="./assets/imagenes/result.png"
                          style="margin-bottom: 5px;">
                          Datos obtenidos
                      </h4>
                  </div>  
                    <div class="col-md-6">
                          <label><i class="fa fa-user"></i> Usuario</label>          
                          <input type="text" class="form-control"  placeholder="Usuario" readonly="true"
                          formControlName="usuario" name="usuario" [(ngModel)]="dat.usuario">    
                          <input type="hidden" class="form-control"  placeholder="Usuario" readonly="true"
                          formControlName="num_suministro" name="num_suministro" [(ngModel)]="dat.num_suministro">     
                      </div>
                      <div class="col-md-6">
                          <label><i class="fa fa-address-card"></i> Dirección</label>
                          <textarea rows="3" class="form-control"  placeholder="Dirección" readonly="true"
                          formControlName="direccion" name="direccion" [(ngModel)]="dat.direccion"></textarea>     
                      </div>
                      <div class="col-md-6"><br>
                          <label><i class="fa fa-home"></i> Municipio</label>          
                          <input type="text" class="form-control"  placeholder="Municipio" readonly="true"
                          formControlName="municipio" name="municipio" [(ngModel)]="dat.municipio">         
                      </div>
                      <div class="col-md-6"><br>
                          <label><i class="fa fa-home"></i> Colonia</label>
                          <input type="text" class="form-control"  placeholder="Colonia" readonly="true"
                          formControlName="colonia" name="colonia" [(ngModel)]="dat.colonia">    
                      </div>
                      <div class="col-md-4"><br>
                          <label><i class="fa fa-network-wired"></i> Red Eléctrica asociada</label>          
                          <input type="text" class="form-control"  placeholder="Red Eléctrica asociada" 
                          formControlName="red_electrica" name="red_electrica" readonly="true" [(ngModel)]="dat.red_electrica">         
                      </div>
                      <div class="col-md-4"><br>
                          <label><i class="fa fa-bolt"></i> Trafo</label>          
                          <input type="text" class="form-control"  placeholder="Trafo" 
                          formControlName="trafo" name="trafo" readonly="true" [(ngModel)]="dat.trafo">         
                      </div>
                      <div class="col-md-4"><br>
                          <label><i class="fa fa-project-diagram"></i> N° de Medidor</label>
                          <input type="text" class="form-control"  placeholder="N° de Medidor" formControlName="medidor" name="medidor"
                          readonly="true" [(ngModel)]="dat.medidor">    
                      </div>
                  </div>
                </form>
               

                
              </div>
            </div>


            <div class="tab-pane" id="ordenesNIS" role="tabpanel" aria-labelledby="">
              <div class="row animated fadeInLeft" 
              style="margin-left: 30px;margin-right: 30px;margin-top: 30px;margin-bottom: 30px;" >
                <div class="col-lg-12">
                  <hr style="background-color: #51F749 !important; height: 2px;">
                  <h4 style="color: #51F749;">
                      <img class="img-profile" src="./assets/imagenes/order.png"
                      style="margin-bottom: 5px;">
                      Órdenes técnicas asociadas al suministro
                  </h4>
                </div>
                <div class="col-md-12" style="max-height: 400px; overflow-y: auto;
                overflow-x: auto;
                margin-top: 25px;">
                    <table  id="ordenesTbl" class="table small mt-5" style="width: 99%;
                    margin:auto">
                        <thead class="thead-dark">
                          <tr>
                            <th style="background-color:#323259; color:#51F749;"
                            class="text-center">N° Orden</th>
                            <th style="background-color:#323259; color:#51F749;"
                            class="text-center">Tipo Orden</th>
                           
                            <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Fecha de asignación</th>
                            <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Descripción</th>
                             <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Usuario resolución</th>
                             <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Fecha de resolución</th>
                             <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Acciones</th>
                        </tr>
                        </thead>
                        <tbody style="background-color:#323259; color:white;text-align: center;
                        font-size: 13px;">
                          <tr *ngFor="let orden  of ordenes" 
                          [ngClass]="{adjuntos: orden.adjuntos > 0}">                        
                           <td >{{orden.orden}}</td>
                           <td style="width: 50%;">{{orden.tipo}}</td>
                           
                           <td>{{orden.fechaAsig}}</td>
                           <td style="width: 50%;">
                                <div style="width:100%; max-height:60px; overflow:auto">
                                    {{orden.descripcion}}
                                </div>
                            </td>
                            <td>{{orden.resolucion}}</td>
                           <td>{{orden.fechaRes}}</td>
                           <td>
                           
                            <button class="btn btn-success btn-sm btn-circle" style="background-color: #51F749;
                           color:black" data-dismiss="modal" data-toggle="modal" data-target="#adjuntarArchivosOrden"
                           (click)="modalAdjuntar(orden, ordenNumeroG)">
                                <i class="fa fa-paperclip"></i>
                           </button> 
                           &nbsp; 
                           <button *ngIf="orden.adjuntos > 0" data-dismiss="modal" data-toggle="modal" 
                             data-target="#adjuntosOrden" (click)="adjuntosOrdenes(orden, ordenNumeroG)"
                            class="btn btn-info btn-sm btn-circle" style="background-color: #008EC4;color:white">
                             <i class="fa fa-eye"></i>
                        </button>
                        </td>
                          
                            </tr>
                        </tbody>
                      </table>
                     
    
                 
                </div>
              </div>
            </div>

            <div class="tab-pane" id="datosENR" role="tabpanel" aria-labelledby="">
              <div class="row animated fadeInRight"
              style="margin-left: 30px;margin-right: 30px;margin-top: 30px;margin-bottom: 30px;" >
                <div class="col-lg-12">
                  <hr style="background-color: #49F7DD !important; height: 2px;">
                  <h4 style="color: #49F7DD;">
                      <img class="img-profile" src="./assets/imagenes/cost.png"
                      style="margin-bottom: 5px;">
                      Generales Cálculo ENR
                  </h4>
                </div>
                <form [formGroup]='frmDatosENR'>
                  <div class="row" *ngFor="let data  of datosENRLista">
                    <div class="col-md-6"><br>
                      <label><i class="fa fa-barcode"></i> Número de Notificación ENR</label>          
                      <input type="text" class="form-control"  placeholder="Número de Notificación ENR"
                      formControlName="nNotificacion" [(ngModel)]="data.nNotiENR">
                      <input type="hidden" class="form-control" 
                      formControlName="caso" [(ngModel)]="data.id">
                    </div>
                    <div class="col-md-6"><br>
                        <label><i class="fa fa-file"></i> Adjunto: Scan de notificacion inicial</label>          
                        <br>
                        <h6 style="color: yellow;font-size: 13px;">{{data.ruta}}</h6>
                        <button class="btn btn-success btn-sm btn-circle"  data-dismiss="modal"
                        (click)="adjuntosOrdenesVer(data.ruta, data.ext)"
                        data-toggle="modal" data-target="#verAdjuntosOrden">
                                <i class="fa fa-eye"></i>
                      </button> 
                        &nbsp; 
                        <a class="btn btn-info btn-sm btn-circle"  
                        [href]="rutaFile+data.ruta">
                                <i class="fa fa-download"></i>
                        </a>
                        &nbsp; 
                        <button class="btn btn-warning btn-sm btn-circle"
                        data-dismiss="modal"
                        (click)="nuevoScan(ordenNumeroG)" 
                        data-toggle="modal" data-target="#nuevoScan">
                                <i class="fa fa-sync"></i>
                      </button> 
                  
                    </div>
                    <div class="col-md-6"><br>
                        <label><i class="fa fa-calendar"></i> Fecha de primera notificación </label>          
                        <input type="date" class="form-control"  formControlName="fechaPrimeraNoti"
                        [(ngModel)]="data.fechaPri">
                  
                    </div>
                    <div class="col-md-6"><br>
                        <label><i class="fa fa-calendar"></i> Fecha de Regularización</label>          
                        <input type="date" (change)="asigFechaFin()" class="form-control" formControlName="fechaRegular"
                        [(ngModel)]="data.fechaR">
                  
                    </div>  
                    <div class="col-md-5"><br>
                        <label><i class="fa fa-archive"></i> Tipo de Caso ENR</label>          
                        <select (change)="asigDias()" class="form-control" formControlName="codTipoENR"
                        [(ngModel)]="data.codigoTipoENR">
                            <option value="0" set selected> Seleccione una opción</option>
                            <option *ngFor="let codENR of codigosENR"  value="{{codENR.id}}">
                                {{codENR.codigoTipo}} -- {{codENR.TipoENR}}
                            </option>
                        </select>         
                    </div>
                    <div class="col-md-2" id="diasData"><br> 
                      <div  *ngFor="let dia  of dias">
                        <label><i class="fa fa-calendar"></i> T. Retroactivo</label>
                        <input type="text" readonly="true" formControlName="diasRetroactivos" class="form-control" [(ngModel)]="dia.diasRetro">
                    </div> 
                    </div>
                     
                   
                    <div class="col-md-5"><br>
                        <label><i class="fa fa-archive"></i> Tipo de Cálculo de metodología ENR</label>          
                        <select class="form-control" formControlName="codTipoMetENR" [(ngModel)]="data.codigoTipoMet">
                            <option value="0" set selected> Seleccione una opción</option>
                            <option *ngFor="let codMetENR of codigosMetENR" value="{{codMetENR.id}}">
                                {{codMetENR.codigo}} -- {{codMetENR.TipoENR}}
                            </option>
                        </select>
                  
                    </div>
        
                    <div class="col-md-4"><br>
                        <label><i class="fa fa-calendar"></i> Fecha de Inicio</label>
                        <input type="date" [(ngModel)]="data.fechaIn" (change)="validarFechaInicio()" class="form-control" formControlName="fechaInicioENR">
                    </div>
                    <div class="col-md-4"><br>
                        <label><i class="fa fa-calendar"></i> Fecha Fin (Limite es fecha regularización)</label>
                        <input type="date" (change)="validarFechas()"   [(ngModel)]="data.fechaFin"
                        id="fechaf" class="form-control" formControlName="fechaFinENR">
                    </div>
                    <div class="col-md-4"><br>
                        <label><i class="fa fa-money-check-alt"></i> Días de Cobro ENR</label>
                        <input type="text" placeholder="Días de Cobro ENR" [(ngModel)]="data.diasCobro"
                        class="form-control" formControlName="diasCobro" readonly="true">
                    </div>
                    <div class="col-md-4"><br>
                      <label><i class="fa fa-comments"></i> Datos adicionales para control interno</label>
                      <textarea rows="4" placeholder="Comentarios o datos adicionales" [(ngModel)]="data.datosAdicionales"
                      class="form-control" formControlName="datosAdicionales"></textarea>
                  </div>

                  <div class="col-md-4"><br>
                    <label><i class="fa fa-bolt"></i> Datos de irregularidades para cartas</label>
                    <textarea rows="4" placeholder="Comentarios o datos adicionales" [(ngModel)]="data.datosIrregulares"
                    class="form-control" formControlName="datosIrregularidades"></textarea>
                </div>

                <div class="col-md-4" *ngIf="data.estado > 1"><br>
                    <label><i class="fa fa-calculator"></i> Datos adicionales de cálculo</label>
                    <textarea rows="4" placeholder="Datos adicionales de cálculo" [(ngModel)]="data.datosCalculo"
                    class="form-control" formControlName="datosCalculo"></textarea>
                </div>

                  </div>
                  <br>
                </form>
                
                <div class="row">
                  <div class="col-lg-12"><br>
                    <hr style="background-color: #D1D104 !important; height: 2px;">
                    <h4 style="color: #D1D104;">
                        <img class="img-profile" src="./assets/imagenes/search.png"
                        style="margin-bottom: 5px;">
                        Agregar documentación probatoria del caso
                    </h4>
                    <form [formGroup]='frm_Archivo'>
                      <div class="row">
                        <div class="col-md-4">
                          <label><i class="fas fa-pencil"></i> Titulo del archivo</label>
                          <textarea  name="tituloDocProbatorio" formControlName="tituloDocProbatorio"  rows="2" class="form-control"
                          placeholder="Titulo del documento"></textarea>
                             
                        </div>
                        <div class="col-md-3">
                          <label><i class="fas fa-file"></i> Tipo de archivo</label>
                          <select class="form-control" name="tipoPruebaProbatorio" formControlName="tipoPruebaProbatorio">
                            <option value="1">Seleccione</option>
                            <option value="Fotografía">Fotografía</option>
                            <option value="Documento">Documento</option>
                            <option value="Otro">Otro</option>
                        </select>
                        </div>
                        <div class="col-md-5">
                          <label><i class="fas fa-upload"></i> Seleccione el archivo</label>
                          <input type="file" name="file" (change)="fileProgress($event)" class="form-control"
                          formControlName="fileProbatorio" style="height:45px"/>
                          <br>
                          <div *ngIf="fileUploadProgress" style="color:white">
                            Upload progress: {{ fileUploadProgress }}
                        </div>
                        <div class="image-preview mb-3" *ngIf="previewUrl">
                            <img [src]="previewUrl" height="150" style="margin-left:25%;"/>    
                           
                        </div>
                        
                        <div class="mb-3" *ngIf="uploadedFilePath">
                            {{uploadedFilePath}}
                        </div>
            
                        </div>
                        
                      
                      <div class="col-md-2"></div>
                      <div class="col-md-8">  
                        <button class="btn btn-warning btn-block"  (click)="onSubmit(ordenNumeroG.caso)">
                          <i class="fas fa-upload"></i> Cargar Archivo
                         </button>
                      </div>
                      <div class="col-md-2"></div>
                    </div><br>
                    </form>
                    <h5 style="color: #FAC092;">Listado de archivos nuevos cargados</h5>
                    <form [formGroup]="docForm">
                        
                        <table class="table small mt-3">
                            <thead class="thead-dark">
                                <tr >
                                    <th style="background-color:#1B1B38; color:#B0B005;font-size: 14px;
                                    border-bottom: 2px solid #B0B005;font-weight: bold;" class="text-center">
                                        <label class="fa fa-pen" style="color:#B0B005 !important;"></label>
                                        Título
                                    </th>
                                    <th style="background-color:#1B1B38; color:#B0B005;font-size: 14px;
                                    border-bottom: 2px solid #B0B005;font-weight: bold;" class="text-center">
                                        <label class="fa fa-archive" style="color:#B0B005 !important;"></label>
                                        Tipo de prueba
                                    </th>
                                    <th style="background-color:#1B1B38; color:#B0B005;font-size: 14px;
                                    border-bottom: 2px solid #B0B005;font-weight: bold;" class="text-center">
                                        <label class="fa fa-file" style="color:#B0B005 !important;"></label>
                                        Archivo
                                    </th>
                                </tr>
                            </thead>
                            <tbody  formArrayName="documentacion"
                            style="background-color:#222245; color:white;text-align: center;
                            font-size: 14px;">
                                <tr *ngFor="let item of documentos.controls; let pointIndex=index" [formGroupName]="pointIndex">
                                    <td style="border-bottom: 1px solid white;"><textarea 
                                        formControlName="nombreDoc" readonly="true"
                                        name="tituloDoc"  rows="2" class="form-control" placeholder="Titulo del documento"></textarea>
                                      <input type="hidden" name="caso" formControlName="caso" class="form-control"></td>
                                    <td style="border-bottom: 1px solid white;">
                                        <select disabled class="form-control" name="tipoPrueba" formControlName="tipoPrueba">
                                        <option value="1">Seleccione</option>
                                        <option value="Fotografía">Fotografía</option>
                                        <option value="Documento">Documento</option>
                                        <option value="Otro">Otro</option>
                                    </select></td>
                                    <td style="border-bottom: 1px solid white;">
                                        <input class="form-control" type="text" formControlName="archivo"
                                        style="height: 45px;" readonly="true"></td>
                                    </tr>
                                
                            </tbody>
                        </table>
                    </form>
                    <br><br>
                    <hr style="background-color: #3AF415 !important; height: 2px;">
                    <button class="btn btn-success btn-block" style="font-weight: bold !important;"
                    data-dismiss="modal"
                    data-toggle="modal" data-target="#guardarDatosConfirm">
                      <i class="fas fa-save"></i> Guardar Todo
                    </button>
                
                    
                    </div>
                </div>
              </div>
            </div>
            <div class="tab-pane" id="docAdjuntos" role="tabpanel" aria-labelledby="">
              <div class="row animated fadeInLeft" 
              style="margin-left: 30px;margin-right: 30px;margin-top: 30px;margin-bottom: 30px;" >
              
              <div class="col-lg-12">
                <hr style="background-color: #D1D104 !important; height: 2px;">
              <h4 style="color: #D1D104;">
                  <img class="img-profile" src="./assets/imagenes/document.png">
                  Adjuntos del caso
              </h4>
              </div>
              <div class="col-md-12" style="max-height: 400px; overflow-y: auto;
                overflow-x: auto;
                margin-top: 25px;">
                <table  id="adjuntos_Tbl" class="table small mt-5" style="width: 100%;
                margin:auto">
                    <thead class="thead-dark">
                    <tr>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Título</th>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Fecha de Creación</th>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Usuario Creador</th>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Archivo</th>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Acciones</th>
                    </tr>
                    </thead>
                    <tbody style="background-color:#323259; color:white;text-align: center;
                    font-size: 13px;">
                    <tr *ngFor="let ad  of adjuntosFile" >                        
                    <td >{{ad.titulo}}</td>
                    <td>{{ad.fechaCreacion}}</td>
                    <td>{{ad.creador}}</td>
                    <td>{{ad.ruta}}</td>
                    <td>
                        <button class="btn btn-success btn-sm btn-circle"  data-dismiss="modal"
                        (click)="adjuntosOrdenesVer(ad.ruta, ad.ext)"
                        data-toggle="modal" data-target="#verAdjuntosOrden">
                                <i class="fa fa-eye"></i>
                    </button> 
                        &nbsp; 
                        <a class="btn btn-info btn-sm btn-circle"  
                        [href]="rutaFile+ad.ruta">
                                <i class="fa fa-download"></i>
                        </a>
                    &nbsp;
                        <button data-dismiss="modal" data-toggle="modal"
                            data-target="#confirmarEliminarAdjunto"
                        (click)="datosEliminarArch(ad.ruta, ad.id, ad)"
                            class="btn btn-danger btn-sm btn-circle">
                            <i class="fa fa-trash"></i>
                        </button>
                    </td>
                    
                        </tr>
                    </tbody>
                </table>
              </div>
              
              </div>
            </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal"
        data-toggle="modal" data-target="#cancelarGuardadoEditar">
          <i class="fas fa-times-circle"></i>  Cerrar!
        </button>
      </div>
    </div>
  </div>
</div>


<!--Modal para ver adjuntos de las ordenes-->
<div class="modal animated fadeInDown" id="adjuntosOrden" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog  mw-100 w-75">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          <img class="img-profile" src="./assets/imagenes/folder.png" width=45 height=45>
          Adjuntos de la orden : <a style="color: #51F749;">{{ordenNumero.orden}}</a> 
          || Tipo de Orden : <a style="color: #51F749;">{{ordenNumero.tipo}}</a>
      </h5>
        
      </div>
      <div class="modal-body">

        <table  id="adjuntos_TblOrdenes" class="table small mt-5" style="width: 100%;
              margin:auto">
                  <thead class="thead-dark">
                    <tr>
                      <th style="background-color:#323259; color:#51F749;"
                       class="text-center">Título</th>
                      <th style="background-color:#323259; color:#51F749;"
                       class="text-center">Tipo de archivo</th>
                      <th style="background-color:#323259; color:#51F749;"
                       class="text-center">Fecha de Creación</th>
                       <th style="background-color:#323259; color:#51F749;"
                       class="text-center">Usuario Creador</th>
                       <th style="background-color:#323259; color:#51F749;"
                       class="text-center">Archivo</th>
                       <th style="background-color:#323259; color:#51F749;"
                       class="text-center">Acciones</th>
                  </tr>
                  </thead>
                  <tbody style="background-color:#323259; color:white;text-align: center;
                  font-size: 13px;">
                    <tr *ngFor="let ad  of adjuntosFileOrdenes" >                        
                     <td >{{ad.titulo}}</td>
                     <td>{{ad.tipo}}</td>
                     <td>{{ad.fechaCreacion}}</td>
                     <td>{{ad.creador}}</td>
                     <td>{{ad.ruta}}</td>
                     <td>
                         <button class="btn btn-success btn-sm btn-circle"  data-dismiss="modal"
                         (click)="adjuntosOrdenesVer(ad.ruta, ad.ext)"
                         data-toggle="modal" data-target="#verAdjuntosOrdenCalidad">
                              <i class="fa fa-eye"></i>
                     </button> 
                         &nbsp; 
                      <a class="btn btn-info btn-sm btn-circle"  
                         [href]="rutaFile+ad.ruta">
                              <i class="fa fa-download"></i>
                      </a>
                     &nbsp;
                         <button data-dismiss="modal" data-toggle="modal"
                          data-target="#confirmarEliminarAdjuntoOT"
                         (click)="datosEliminarArchOT(ad.ruta, ad.id, ad, ordenNumeroG)"
                          class="btn btn-danger btn-sm btn-circle">
                           <i class="fa fa-trash"></i>
                      </button>
                     </td>
                    
                      </tr>
                  </tbody>
        </table>
     </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal"
        data-toggle="modal" data-target="#datosCaso">
          <i class="fas fa-times-circle"></i>  Cerrar
        </button>          
      </div>
    </div>
  </div>
</div>


<!--Modal para visor de archivos de ordenes -->
<div class="modal animated fadeInDown" id="verAdjuntosOrdenCalidad" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog  mw-100 w-75">
    <div class="modal-content">
      <div class="modal-header">
      </div>
      <div class="modal-body">
        
        <div *ngIf="adjuntosOrdenesVer">
            <div *ngIf="extension == 'pdf'">
              <iframe [src]="adjuntoVer" width="100%" height="450px"></iframe>
            </div>
            <div *ngIf="extension == 'jpg' ">
              <img [src]="adjuntoVer" width="650px" height="450px"
              style="margin-left: 20%;"/>
            </div>
  
            <div *ngIf="extension == 'png' ">
              <img [src]="adjuntoVer" width="650px" height="450px"
              style="margin-left: 20%;"/>
            </div>
            <div *ngIf="extension == 'txt' ">
              <h2 style="color:yellow;text-align: center;">El formato .txt solo puede ser descargado</h2>
            </div>
          </div>
        
      
     </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal"
          data-toggle="modal" data-target="#adjuntosOrden">
          <i class="fas fa-times-circle"></i>  Cerrar
        </button>          
      </div>
    </div>
  </div>
</div>


<!--Modal de confirmacion para confirmar eliminar-->
<div class="modal animated fadeInLeft" id="confirmarEliminarAdjuntoOT" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content modal-lg">
      <div class="modal-header">
        <h5 class="title" style="color:#0CD902 !important;">
          <img class="img-profile" src="./assets/imagenes/confirm.png" width=35 height=35>
          Confirmación
        </h5>
        
      </div>
      <div class="modal-body">
        <form [formGroup]='frm_ArchivoEliminarOT'>
          
          <input type="hidden" class="form-control"
          formControlName="idEliminar" name="idEliminar"> 
          <input type="hidden" class="form-control"
          formControlName="rutaEliminar" name="rutaEliminar"> 
      </form>    

        <h6 style="text-align: center;color: #67E1E1;">¿Desea eliminar el archivo 
          <a style="color:yellow">"{{archivoEliminarOT.ruta}}"</a>
          asociado a la orden 
          <a style="color:yellow">"{{archivoEliminarOT.orden}}"</a>?</h6>
        <h5 style="text-align: center;color: #FC0505;">¡Se borrará de todo el repositorio de archivos!</h5>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-info" data-dismiss="modal" 
        data-toggle="modal" data-target="#adjuntosOrden">
          <i class="fas fa-times-circle"></i>  No!
        </button>
        <button type="button" class="btn btn-danger" data-dismiss="modal"
        (click)="eliminarArchivoOT(archivoEliminarOT, datosPadre)"
        data-toggle="modal" data-target="#adjuntosOrden">
          <i class="fas fa-thumbs-up"></i>  Si, eliminar!
        </button>
        
        
      </div>
    </div>
  </div>
</div>



<!--Modal para adjuntar archivos a las OT-->
<div class="modal animated fadeInRight" data-backdrop="static" data-keyboard="false" 
tabindex="-1" role="dialog" id="adjuntarArchivosOrden">
    <div class="modal-dialog mw-100 w-75" >
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">
            <img class="img-profile" src="./assets/imagenes/attach.png" width=45 height=45>
            Adjuntar archivos a la orden : <a style="color: #51F749;">{{ordenNumeroAd.orden}}</a> 
            || Tipo de Orden : <a style="color: #51F749;">{{ordenNumeroAd.tipo}}</a>
        </h5>
        </div>
        <div class="modal-body">
          
          <form [formGroup]='frm_ArchivoOT'>
            <div class="row">
              <div class="col-md-3">
                <label><i class="fas fa-pencil"></i> Titulo del archivo</label>
                <textarea  name="tituloDocProbatorioOT" formControlName="tituloDocProbatorioOT"  rows="2" class="form-control"
                placeholder="Titulo del documento"></textarea>
                   
              </div>
              <div class="col-md-3">
                <label><i class="fas fa-file"></i> Tipo de archivo</label>
                <select class="form-control" name="tipoPruebaProbatorioOT" formControlName="tipoPruebaProbatorioOT">
                  <option value="1" set selected>Seleccione</option>
                  <option value="Visita Inspección Técnica">Visita Inspección Técnica</option>
                  <option value="Cambio de Medidor">Cambio de Medidor</option>
                  <option value="Verificación de Lectura">Verificación de Lectura</option>
            </select>
              </div>
              <div class="col-md-4">
                <label><i class="fas fa-upload"></i> Seleccione el archivo</label>
                <input type="file" name="file" (change)="fileProgress2($event)" class="form-control"
                formControlName="fileProbatorioOT" style="height:45px"/>
                <br>
                
              <div class="image-preview mb-3" *ngIf="previewUrl1">
                  <img [src]="previewUrl1" height="150" style="margin-left:25%;"/>                  
              </div>
              </div>
              <div class="col-md-2">
                <label style="color: #1B1B38 !important"><i class="fas fa-upload"></i> Seleccione el archivo</label>
                <button class="btn btn-warning"  (click)="onSubmit2(ordenNumeroAd.orden)">
                  <i class="fas fa-upload"></i> Cargar Archivo
                 </button>
              </div>
            </div><br>
            
          </form>
          <h5 style="color: #FAC092;">Listado de archivos cargados</h5>


            <form [formGroup]="adjuntoOrdenesForm" enctype="multipart/form-data">
              
                <table class="table small mt-3">
                    <thead class="thead-dark">
                        <tr >
                            <th style="background-color:#323259; color:#51F749;font-size: 14px;
                            border-bottom: 2px solid #51F749;font-weight: bold;" class="text-center">
                                <label class="fa fa-pen" style="color:#51F749 !important;"></label>
                                OT
                            </th>
                            <th style="background-color:#323259; color:#51F749;font-size: 14px;
                            border-bottom: 2px solid #51F749;font-weight: bold;" class="text-center">
                                <label class="fa fa-pen" style="color:#51F749 !important;"></label>
                                Título
                            </th>
                            <th style="background-color:#323259; color:#51F749;font-size: 14px;
                        border-bottom: 2px solid #51F749;font-weight: bold;" class="text-center">
                            <label class="fa fa-archive" style="color:#51F749 !important;"></label>
                            Tipo de adjunto
                        </th>
                            <th style="background-color:#323259; color:#51F749;font-size: 14px;
                            border-bottom: 2px solid #51F749;font-weight: bold;" class="text-center">
                                <label class="fa fa-file" style="color:#51F749 !important;"></label>
                                Archivo
                            </th>
                        </tr>
                    </thead>
                    <tbody  formArrayName="documentacionOrden"
                    style="background-color:#222245; color:white;text-align: center;font-size: 11px;">
                       
                    <tr *ngFor="let item of adjuntos.controls; let pointIndex=index" [formGroupName]="pointIndex">
                        <td style="border-bottom: 1px solid white;">
                            <input class="form-control" type="text" formControlName="ordenN" readonly="true">
                        </td>
                        <td style="border-bottom: 1px solid white;"><textarea 
                            formControlName="nombreDocOrden" readonly="true"
                             rows="2" class="form-control" placeholder="Titulo del documento"></textarea></td>
                             <td style="border-bottom: 1px solid white;">
                                <select disabled class="form-control" name="tipoAdjuntoOrden" formControlName="tipoAdjuntoOrden">
                                <option value="1">Seleccione</option>
                                <option value="Visita Inspección Técnica">Visita Inspección Técnica</option>
                                <option value="Cambio de Medidor">Cambio de Medidor</option>
                                <option value="Verificación de Lectura">Verificación de Lectura</option>
                            </select>
                        </td>
                        <td style="border-bottom: 1px solid white;">
                            <textarea class="form-control" rows="2" readonly="true"
                             formControlName="file" name="file"></textarea>
                             <input type="hidden" formControlName="idUsuario">
                        </td>
                        
                    </tr>
                    </tbody>
                </table>
            </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" data-toggle="modal" data-target="#cancelarGuardadoAdjuntos">
            <i class="fas fa-times-circle"></i>  Cerrar
          </button>
          <button type="button" class="btn btn-default save" data-dismiss="modal" data-toggle="modal" data-target="#guardarAdjuntosConfirm" 
          (click)="datosOrdenAdjuntos(ordenNumeroGN)">
            <i class="fas fa-paperclip"></i>  Adjuntar
          </button>
          
        </div>
      </div>
    </div>
</div>



<div class="modal animated fadeInUp" id="cancelarGuardadoAdjuntos" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="title" style="color:#0CD902 !important;">
          <img class="img-profile" src="./assets/imagenes/confirm.png" width=35 height=35>
          Confirmación
        </h5>
        
      </div>
      <div class="modal-body">
       
        <h4 style="text-align: center;color: #67E1E1;">¿Desea cerrar la ventana?</h4>
        <h5 style="text-align: center;color: #FC0505;">¡La información no guardada se perderá!</h5>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-info" data-dismiss="modal"
        data-toggle="modal" data-target="#adjuntarArchivosOrden">
          <i class="fas fa-times-circle"></i>  No!
        </button>
        <button type="button" class="btn btn-danger" data-dismiss="modal" data-toggle="modal"
        data-target="#datosCaso">
          <i class="fas fa-thumbs-up"></i>  Si, cerrar!
        </button>
        
        
      </div>
    </div>
  </div>
</div>


<!---Modal de alerta para confirmar guardado de adjuntos-->
<div class="modal animated fadeInDown" id="guardarAdjuntosConfirm" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="title" style="color:#0CD902 !important;">
          <img class="img-profile" src="./assets/imagenes/confirm.png" width=35 height=35>
          Confirmación
        </h5>
        
      </div>
      <div class="modal-body">
       
        <h4 style="text-align: center;color: #67E1E1;">¿Desea adjuntar los archivos?</h4>
      
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal" data-toggle="modal" data-target="#adjuntarArchivosOrden">
          <i class="fas fa-times-circle"></i>  No!
        </button>
        <button type="button" class="btn btn-default save" data-dismiss="modal"
        data-toggle="modal" data-target="#datosCaso"  (click)="guardarAdjuntosOT(ordenNumeroGN)">
          <i class="fas fa-thumbs-up"></i>  Si, adjuntar!
        </button>
        
        
      </div>
    </div>
  </div>
</div>


<!---Modal de para cambio de scan-->
<div class="modal animated fadeInRight" data-backdrop="static" data-keyboard="false" 
tabindex="-1" role="dialog" id="nuevoScan">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" style="font-size: 15px;">
            <img class="img-profile" src="./assets/imagenes/attach.png" width=45 height=45>
            Nuevo Scan de notificación inicial para el caso: <a style="color: #51F749;">{{ordenNumeroG.caso}}</a> 
            
        </h5>
        </div>
        <div class="modal-body">
         
          <form [formGroup]='frm_NuevoScan'>
            <div class="row" *ngFor="let dataScan  of datosENRListaScan">
              <div class="col-md-12">
                <label><i class="fas fa-upload"></i> Seleccione el archivo</label>
                <input type="file" name="nuevoScanENR" (change)="fileProgress3($event)" class="form-control"
                formControlName="nuevoScanENR" style="height:45px"/>
                <input type="hidden" name="idCambio"  class="form-control"
                formControlName="idCambio" [(ngModel)] ="dataScan.caso">

                <input type="hidden" name="rutaVieja"  class="form-control"
                formControlName="rutaVieja" [(ngModel)] ="dataScan.ruta">
                <br>
                
              <div class="image-preview mb-3" *ngIf="previewUrl2">
                  <img [src]="previewUrl2" height="150" style="margin-left:25%;"/>                  
              </div>
              </div>
              <div class="col-md-12">
                <label style="color: #1B1B38 !important"><i class="fas fa-upload"></i> Seleccione el archivo</label>
                <button class="btn btn-warning btn-block"  (click)="onSubmit3(ordenNumeroG)"
                data-dismiss="modal" data-toggle="modal" data-target="#datosCaso">
                  <i class="fas fa-upload"></i> Cargar Archivo
                 </button>
              </div>
            </div><br>
            
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" 
          data-toggle="modal" data-target="#datosCaso">
            <i class="fas fa-times-circle"></i>  Cerrar
          </button>
      
        </div>
      </div>
    </div>
</div>

<!---Modal de alerta para confirmar cancelado de edicion  de caso ENR-->
<div class="modal animated fadeInUp" id="cancelarGuardadoEditar" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="title" style="color:#0CD902 !important;">
          <img class="img-profile" src="./assets/imagenes/confirm.png" width=35 height=35>
          Confirmación
        </h5>
        
      </div>
      <div class="modal-body">
       
        <h4 style="text-align: center;color: #67E1E1;">¿Desea cerrar la ventana?</h4>
        <h5 style="text-align: center;color: #FC0505;">¡La información no guardada se perderá!</h5>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-info" data-dismiss="modal"
        data-toggle="modal" data-target="#datosCaso">
          <i class="fas fa-times-circle"></i>  No!
        </button>
        <button type="button" class="btn btn-danger" data-dismiss="modal">
          <i class="fas fa-thumbs-up"></i>  Si, cerrar!
        </button>
        
        
      </div>
    </div>
  </div>
</div>

<!---Modal de alerta para confirmar guardado de caso ENR-->
<div class="modal animated fadeInDown" id="guardarDatosConfirm" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="title" style="color:#0CD902 !important;">
          <img class="img-profile" src="./assets/imagenes/confirm.png" width=35 height=35>
          Confirmación
        </h5>
        
      </div>
      <div class="modal-body">
       
        <h4 style="text-align: center;color: #67E1E1;">¿Desea editar el caso ENR?</h4>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal"
        data-toggle="modal" data-target="#datosCaso">
          <i class="fas fa-times-circle"></i>  No!
        </button>
        <button type="button" class="btn btn-default save" data-dismiss="modal"  
        (click)="guardarDatos(ordenNumeroG)" data-toggle="modal" data-target="#datosCaso">
          <i class="fas fa-thumbs-up"></i>  Si, guardar!
        </button>
        
        
      </div>
    </div>
  </div>
</div>

<!---Modal de alerta para confirmar cancelado de calculo  de caso ENR-->
<div class="modal animated fadeInDown" id="cancelarGuardadoCalculo" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="title" style="color:#0CD902 !important;">
          <img class="img-profile" src="./assets/imagenes/confirm.png" width=35 height=35>
          Confirmación
        </h5>
        
      </div>
      <div class="modal-body">
       
        <h4 style="text-align: center;color: #67E1E1;">¿Desea cerrar la ventana?</h4>
        <h5 style="text-align: center;color: #FC0505;">¡La información no guardada se perderá!</h5>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-info" data-dismiss="modal">
          <i class="fas fa-times-circle"></i>  No!
        </button>
        <button type="button" class="btn btn-danger" data-dismiss="modal"
        (click)="cerrarCalculo()">
          <i class="fas fa-thumbs-up"></i>  Si, cerrar!
        </button>
        
        
      </div>
    </div>
  </div>
</div>



<!--modal para detalles de lectura del NIS-->

<div class="modal animated fadeInLeft" id="mostrarLecturas" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog mw-100 w-75" >
    <div class="modal-content">
      <div class="modal-header" >
        <h6 class="title" style="color:#B18AFF !important;margin-right: 40px;">
          <img class="img-profile" src="./assets/imagenes/editModal.png" width=35 height=35>
          Lecturas del NIS: <a style="color: #0CD902;">{{datosGeneralesLecturas.num_suministro}}</a>
        </h6>
      </div>
      <div class="modal-body" style="max-height: calc(100vh - 200px);
      overflow-y: auto;overflow-x: hidden;">

      <table  id="lecturas_Tbl" class="table small mt-5" style="width: 99%;
      margin:auto">
          <thead class="thead-dark">
            <tr>
              <th></th>
              <th style="background-color:#323259; color:#51F749;"
              class="text-center">Período </th>
              <th style="background-color:#323259; color:#51F749;"
              class="text-center">N° Medidor </th>
              <th style="background-color:#323259; color:#51F749;"
              class="text-center">Fecha Lectura Ant.</th>
            
              <th style="background-color:#323259; color:#51F749;"
              class="text-center">Fecha Lectura</th>
              <th style="background-color:#323259; color:#51F749;"
              class="text-center">Días Facturados</th>
              <th style="background-color:#323259; color:#51F749;"
              class="text-center">Consumo Facturado</th>
              <th style="background-color:#323259; color:#51F749;"
              class="text-center">Acciones</th>
             
          </tr>
          </thead>
          <tbody style="background-color:#323259; color:white;text-align: center;
          font-size: 13px;">
            <tr *ngFor="let lec  of lecturasArray, let i= index" id="tr{{lec.periodo}}">     
            <td>{{lec.anio}}</td>                   
            <td>{{lec.periodo}}</td>
            <td>{{lec.medidor}}</td>
            <td>{{lec.fechaLecturaAnterior}}</td>          
            <td>{{lec.fechaLectura}}</td>
            <td>{{lec.diasFacturado}}</td>
            <td>{{lec.consumo}}</td>
            <td>
            
              <button id="add{{lec.periodo}}" class="calc btn btn-success btn-sm btn-circle" style="background-color: #51F749;
            color:black" (click)="agregarLectura(lec.periodo,lec.fechaLecturaAnterior,lec.fechaLectura,
            lec.diasFacturado,lec.consumo,i)">
                  <i class="fa fa-hand-pointer"></i>
            </button>  
            <button id="remove{{lec.periodo}}" class="btn btn-danger btn-sm btn-circle" style="display:none"
            (click)="eliminarLecturaTbl(lec.periodo)">
              <i class="fa fa-trash"></i>
            </button>
          </td>
            
              </tr>
          </tbody>
        </table>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="cancelarModalLecturas()">
          <i class="fas fa-times"></i>  Cancelar 
        </button>
        <button type="button" class="btn btn-info" (click)="hideModalLecturas()" style="color:black !important;">
          <i class="fas fa-check"></i>  Finalizar selección! 
        </button>
      </div>
    </div>
  </div>
</div>


<!--modal de confirmación para guardar calculos-->
<div class="modal animated fadeInDown" id="guardarDatosFinalesConfirm" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="title" style="color:#0CD902 !important;">
          <img class="img-profile" src="./assets/imagenes/confirm.png" width=35 height=35>
          Confirmación
        </h5>
        
      </div>
      <div class="modal-body">
       
        <h4 style="text-align: center;color: #67E1E1;">¿Desea guardar el cálculo del caso ENR?</h4>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">
          <i class="fas fa-times-circle"></i>  No!
        </button>
        <button type="button" class="btn btn-default save" data-dismiss="modal"  
        (click)="guardarDatosFinales()">
          <i class="fas fa-thumbs-up"></i>  Si, guardar!
        </button>
        
        
      </div>
    </div>
  </div>
</div>


<!--modal de selección de archivos a imprimir-->

<div class="modal animated fadeInLeft" id="datosImprimir" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog mw-100 w-75" >
    <div class="modal-content">
      <div class="modal-header" >
        <h5 class="modal-title">
          <img class="img-profile" src="./assets/imagenes/print.png" width=45 height=45>
          Caso N°:  <a style="color: #51F749;">{{datoImprimir.caso}}</a> 
          || Metodología de cálculo : <a style="color: #51F749;">{{datoImprimir.metodologiaENR}}</a> 
          || NIS : <a style="color: #51F749;">{{datoImprimir.nis}}</a> 
        </h5>
       
      </div>
      <div class="modal-body" style="max-height: calc(100vh - 200px);
      overflow-y: auto;overflow-x: hidden;">

        <h5 style="font-weight: bold;color: #00FFEA;text-align: center;">
          <img class="img-profile" src="./assets/imagenes/education.png" width=45 height=45>
          Documentos disponibles para adjuntar en reporte de notificación</h5>
          <hr style="height:2px; background-color: #00FFEA;">
        <table  id="filePrint" class="table small mt-5" style="width: 100%;margin:auto">
                  <thead class="thead-dark">
                    <tr>
                      <th style="background-color:#323259; color:#51F749;"
                      class="text-center">Título</th>
                      <th style="background-color:#323259; color:#51F749;"
                      class="text-center">Archivo</th>
                      <th style="background-color:#323259; color:#51F749;"
                      class="text-center">Acciones</th>
                  </tr>
                  </thead>
                  <tbody style="background-color:#323259; color:white;text-align: center;
                  font-size: 13px;">
                    <tr *ngFor="let file  of datoImprimirObj, let i= index" id="trPDF{{file.id}}">                        
                    <td >{{file.titulo}}</td>
                    <td>{{file.ruta}}</td>
                    <td>
                      <button id="addPDF{{file.id}}" class="calc btn btn-success btn-sm btn-circle" style="background-color: #51F749;
                    color:black" (click)="agregarPDF(file.id, file.ruta)">
                          <i class="fa fa-hand-pointer"></i>
                    </button>  
                    <button id="removePDF{{file.id}}" class="btn btn-danger btn-sm btn-circle" style="display:none"
                    (click)="eliminarPdfTbl(file.id)">
                      <i class="fa fa-trash"></i>
                    </button>
                    </td>
                    
                      </tr>
                  </tbody>
        </table>

        <form [formGroup]="frm_PdfEvaluar" style="display: none;">
          <table class="table small mt-3">
            <thead class="thead-dark">
                <tr >
                    <th style="background-color: #1B1B38;color:#1FE303;font-size: 13px;
                    border-bottom: 2px solid #1FE303;font-weight: bold;" class="text-center">
                        Archivo
                    </th>
                   
                </tr>
            </thead>
            <tbody  formArrayName="pdfs"
            style="background-color:#222245; color:white;text-align: center;
            font-size: 14px;">
                <tr *ngFor="let item of pdfs.controls; let pointIndex=index" [formGroupName]="pointIndex">
                   
                    <td style="border-bottom: 1px solid #A4FA98;">
                      <input class="form-control" type="text" formControlName="archivo" name="archivo"
                      style="text-align: center !important;color: #A4FA98 !important;" readonly="true">
                     
                      <button class="btn btn-danger btn-sm btn-circle" id="btnElPDF{{item.value.id}}"
                      style="display: none;"
                      (click)="eliminarPDF(pointIndex,item.value.id)"><i class="fas fa-trash"></i></button>
                  
                    </td>
                   
                  
                </tr>
                
            </tbody>
            
        </table>
        </form>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">
          <i class="fas fa-times-circle"></i>  Cancelar!
        </button>
        <button type="button" class="btn btn-info"  style="color:black !important;"
        (click)="fusionarPDF(datoImprimir, datoImprimir.caso)" data-dismiss="modal">
          <i class="fas fa-print"></i>  Generar reporte! 
        </button>

     
      </div>
    </div>
  </div>
</div>



<!--Modal para ver datos de caso ENR calculados-->

<div class="modal animated fadeInDown" id="datosCasoCalc" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog mw-100 w-75" >
    <div class="modal-content">
      <div class="modal-header" >
        
        <div class="row" style="margin-left: 30px;">
          <ul class="nav nav-tabs" id="myTab" role="tablist" >
          <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#datosNISCN" role="tab"
            aria-controls="home" aria-selected="true" style="color:#FB51EE;background-color: #1B1B38;">
            <i class="fas fa-cogs"></i>
            Datos del NIS
            </a>
          </li>
          <li class="nav-item" style="border-bottom:1px solid white;">
            <a class="nav-link"  data-toggle="tab" href="#ordenesNISCN" role="tab"
            aria-controls="profile" aria-selected="false" style="color:#51F749;background-color: #1B1B38;">
            <i class="fas fa-paperclip"></i>
                Órdenes tec. del NIS
            </a>
          </li>
          <li class="nav-item" style="border-bottom:1px solid white;">
            <a class="nav-link"  data-toggle="tab" href="#datosENRCN" role="tab"
            aria-controls="profile" aria-selected="false" style="color:#49F7DD;background-color: #1B1B38;">
            <i class="fas fa-money-bill-alt"></i>
                Datos de ENR
            </a>
          </li>
          <li class="nav-item" style="border-bottom:1px solid white;">
            <a class="nav-link"  data-toggle="tab" href="#docAdjuntosCN" role="tab"
            aria-controls="profile" aria-selected="false" style="color:#D1D104;background-color: #1B1B38;">
            <i class="fas fa-file"></i>
                Adjuntos
            </a>
          </li>
        </ul>
        </div>
        <h6 class="title" style="color:#B18AFF !important;margin-right: 40px;">
          Caso N°: <a style="color: #0CD902;">{{ordenNumeroG.caso}}</a><br>
          Usuario creacion: <a style="color: #0CD902;">{{ordenNumeroG.usuarioCreacion}}</a> 
        </h6>
      </div>
      <div class="modal-body" style="max-height: calc(100vh - 200px);
      overflow-y: auto;overflow-x: hidden;">
        
        <div class="tab-content" id="myTabContent" style="background-color: #323259;margin-right: 30px;
        margin-left: 30px;border: 1px solid white;
       max-height: calc(100vh - 200px);
      overflow-y: auto;overflow-x: hidden;">
            <div class="tab-pane fade show active" id="datosNISCN" role="tabpanel" aria-labelledby="">
              <div class="row animated fadeInRight" *ngFor="let dat  of datos">
                
                <form [formGroup]='frm_DatosNIS'>
                  <div class="row" style="margin-left: 30px;margin-right: 30px;margin-top: 30px;margin-bottom: 30px;" >
                    <div class="col-lg-12">
                      <hr style="background-color: #FB51EE !important;height: 2px;">
              
                      <h4 style="color: #FB51EE;">
                          <img class="img-profile" src="./assets/imagenes/result.png"
                          style="margin-bottom: 5px;">
                          Datos obtenidos
                      </h4>
                  </div>  
                    <div class="col-md-6">
                          <label><i class="fa fa-user"></i> Usuario</label>          
                          <input type="text" class="form-control"  placeholder="Usuario" readonly="true"
                          formControlName="usuario" name="usuario" [(ngModel)]="dat.usuario">    
                          <input type="hidden" class="form-control"  placeholder="Usuario" readonly="true"
                          formControlName="num_suministro" name="num_suministro" [(ngModel)]="dat.num_suministro">     
                      </div>
                      <div class="col-md-6">
                          <label><i class="fa fa-address-card"></i> Dirección</label>
                          <textarea rows="3" class="form-control"  placeholder="Dirección" readonly="true"
                          formControlName="direccion" name="direccion" [(ngModel)]="dat.direccion"></textarea>     
                      </div>
                      <div class="col-md-6"><br>
                          <label><i class="fa fa-home"></i> Municipio</label>          
                          <input type="text" class="form-control"  placeholder="Municipio" readonly="true"
                          formControlName="municipio" name="municipio" [(ngModel)]="dat.municipio">         
                      </div>
                      <div class="col-md-6"><br>
                          <label><i class="fa fa-home"></i> Colonia</label>
                          <input type="text" class="form-control"  placeholder="Colonia" readonly="true"
                          formControlName="colonia" name="colonia" [(ngModel)]="dat.colonia">    
                      </div>
                      <div class="col-md-4"><br>
                          <label><i class="fa fa-network-wired"></i> Red Eléctrica asociada</label>          
                          <input type="text" class="form-control"  placeholder="Red Eléctrica asociada" 
                          formControlName="red_electrica" name="red_electrica" readonly="true" [(ngModel)]="dat.red_electrica">         
                      </div>
                      <div class="col-md-4"><br>
                          <label><i class="fa fa-bolt"></i> Trafo</label>          
                          <input type="text" class="form-control"  placeholder="Trafo" 
                          formControlName="trafo" name="trafo" readonly="true" [(ngModel)]="dat.trafo">         
                      </div>
                      <div class="col-md-4"><br>
                          <label><i class="fa fa-project-diagram"></i> N° de Medidor</label>
                          <input type="text" class="form-control"  placeholder="N° de Medidor" formControlName="medidor" name="medidor"
                          readonly="true" [(ngModel)]="dat.medidor">    
                      </div>
                  </div>
                </form>
               

                
              </div>
            </div>


            <div class="tab-pane" id="ordenesNISCN" role="tabpanel" aria-labelledby="">
              <div class="row animated fadeInLeft" 
              style="margin-left: 30px;margin-right: 30px;margin-top: 30px;margin-bottom: 30px;" >
                <div class="col-lg-12">
                  <hr style="background-color: #51F749 !important; height: 2px;">
                  <h4 style="color: #51F749;">
                      <img class="img-profile" src="./assets/imagenes/order.png"
                      style="margin-bottom: 5px;">
                      Órdenes técnicas asociadas al suministro
                  </h4>
                </div>
                <div class="col-md-12" style="max-height: 400px; overflow-y: auto;
                overflow-x: auto;
                margin-top: 25px;">
                    <table  id="ordenesTbl" class="table small mt-5" style="width: 99%;
                    margin:auto">
                        <thead class="thead-dark">
                          <tr>
                            <th style="background-color:#323259; color:#51F749;"
                            class="text-center">N° Orden</th>
                            <th style="background-color:#323259; color:#51F749;"
                            class="text-center">Tipo Orden</th>
                           
                            <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Fecha de asignación</th>
                            <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Descripción</th>
                             <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Usuario resolución</th>
                             <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Fecha de resolución</th>
                             <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Acciones</th>
                        </tr>
                        </thead>
                        <tbody style="background-color:#323259; color:white;text-align: center;
                        font-size: 13px;">
                          <tr *ngFor="let orden  of ordenes" 
                          [ngClass]="{adjuntos: orden.adjuntos > 0}">                        
                           <td >{{orden.orden}}</td>
                           <td style="width: 50%;">{{orden.tipo}}</td>
                           
                           <td>{{orden.fechaAsig}}</td>
                           <td style="width: 50%;">
                                <div style="width:100%; max-height:60px; overflow:auto">
                                    {{orden.descripcion}}
                                </div>
                            </td>
                            <td>{{orden.resolucion}}</td>
                           <td>{{orden.fechaRes}}</td>
                           <td>
                           
                            <button class="btn btn-success btn-sm btn-circle" style="background-color: #51F749;
                           color:black" data-dismiss="modal" data-toggle="modal" data-target="#adjuntarArchivosOrden"
                           (click)="modalAdjuntar(orden, ordenNumeroG)">
                                <i class="fa fa-paperclip"></i>
                           </button> 
                           &nbsp; 
                           <button *ngIf="orden.adjuntos > 0" data-dismiss="modal" data-toggle="modal" 
                             data-target="#adjuntosOrden" (click)="adjuntosOrdenes(orden, ordenNumeroG)"
                            class="btn btn-info btn-sm btn-circle" style="background-color: #008EC4;color:white">
                             <i class="fa fa-eye"></i>
                        </button>
                        </td>
                          
                            </tr>
                        </tbody>
                      </table>
                     
    
                 
                </div>
              </div>
            </div>

            <div class="tab-pane" id="datosENRCN" role="tabpanel" aria-labelledby="">
              <div class="row animated fadeInRight"
              style="margin-left: 30px;margin-right: 30px;margin-top: 30px;margin-bottom: 30px;" >
                <div class="col-lg-12">
                  <hr style="background-color: #49F7DD !important; height: 2px;">
                  <h4 style="color: #49F7DD;">
                      <img class="img-profile" src="./assets/imagenes/cost.png"
                      style="margin-bottom: 5px;">
                      Generales Cálculo ENR
                  </h4>
                </div>
                <form [formGroup]='frmDatosENR'>
                  <div class="row" *ngFor="let data  of datosENRLista">
                    <div class="col-md-6"><br>
                      <label><i class="fa fa-barcode"></i> Número de Notificación ENR</label>          
                      <input type="text" class="form-control"  placeholder="Número de Notificación ENR"
                      formControlName="nNotificacion" [(ngModel)]="data.nNotiENR">
                      <input type="hidden" class="form-control" 
                      formControlName="caso" [(ngModel)]="data.id">
                    </div>
                    <div class="col-md-6"><br>
                        <label><i class="fa fa-file"></i> Adjunto: Scan de notificacion inicial</label>          
                        <br>
                        <h6 style="color: yellow;font-size: 13px;">{{data.ruta}}</h6>
                        <button class="btn btn-success btn-sm btn-circle"  data-dismiss="modal"
                        (click)="adjuntosOrdenesVer(data.ruta, data.ext)"
                        data-toggle="modal" data-target="#verAdjuntosOrden">
                                <i class="fa fa-eye"></i>
                      </button> 
                        &nbsp; 
                        <a class="btn btn-info btn-sm btn-circle"  
                        [href]="rutaFile+data.ruta">
                                <i class="fa fa-download"></i>
                        </a>
                        &nbsp; 
                        <button class="btn btn-warning btn-sm btn-circle"
                        data-dismiss="modal"
                        (click)="nuevoScan(ordenNumeroG)" 
                        data-toggle="modal" data-target="#nuevoScan">
                                <i class="fa fa-sync"></i>
                      </button> 
                  
                    </div>
                    <div class="col-md-6"><br>
                        <label><i class="fa fa-calendar"></i> Fecha de primera notificación </label>          
                        <input type="date" class="form-control"  formControlName="fechaPrimeraNoti"
                        [(ngModel)]="data.fechaPri" readonly="true">
                  
                    </div>
                    <div class="col-md-6"><br>
                        <label><i class="fa fa-calendar"></i> Fecha de Regularización</label>          
                        <input type="date" (change)="asigFechaFin()" class="form-control" formControlName="fechaRegular"
                        [(ngModel)]="data.fechaR" readonly="true">
                  
                    </div>  
                    <div class="col-md-5"><br>
                        <label><i class="fa fa-archive"></i> Tipo de Caso ENR</label>          
                        <select (change)="asigDias()" class="form-control" formControlName="codTipoENR"
                        [(ngModel)]="data.codigoTipoENR" disabled="true">
                            <option value="0" set selected> Seleccione una opción</option>
                            <option *ngFor="let codENR of codigosENR"  value="{{codENR.id}}">
                                {{codENR.codigoTipo}} -- {{codENR.TipoENR}}
                            </option>
                        </select>         
                    </div>
                    <div class="col-md-2" id="diasData"><br> 
                      <div  *ngFor="let dia  of dias">
                        <label><i class="fa fa-calendar"></i> T. Retroactivo</label>
                        <input type="text" readonly="true" formControlName="diasRetroactivos" class="form-control" [(ngModel)]="dia.diasRetro">
                    </div> 
                    </div>
                     
                   
                    <div class="col-md-5"><br>
                        <label><i class="fa fa-archive"></i> Tipo de Cálculo de metodología ENR</label>          
                        <select class="form-control" formControlName="codTipoMetENR" disabled="true" [(ngModel)]="data.codigoTipoMet">
                            <option value="0" set selected> Seleccione una opción</option>
                            <option *ngFor="let codMetENR of codigosMetENR" value="{{codMetENR.id}}">
                                {{codMetENR.codigo}} -- {{codMetENR.TipoENR}}
                            </option>
                        </select>
                  
                    </div>
        
                    <div class="col-md-4"><br>
                        <label><i class="fa fa-calendar"></i> Fecha de Inicio</label>
                        <input type="date" [(ngModel)]="data.fechaIn" readonly="true" (change)="validarFechaInicio()" class="form-control" formControlName="fechaInicioENR">
                    </div>
                    <div class="col-md-4"><br>
                        <label><i class="fa fa-calendar"></i> Fecha Fin (Limite es fecha regularización)</label>
                        <input type="date" (change)="validarFechas()"   [(ngModel)]="data.fechaFin"
                        id="fechaf" class="form-control" formControlName="fechaFinENR" readonly="true">
                    </div>
                    <div class="col-md-4"><br>
                        <label><i class="fa fa-money-check-alt"></i> Días de Cobro ENR</label>
                        <input type="text" placeholder="Días de Cobro ENR" [(ngModel)]="data.diasCobro"
                        class="form-control" formControlName="diasCobro" readonly="true">
                    </div>
                    <div class="col-md-4"><br>
                      <label><i class="fa fa-comments"></i> Datos adicionales para control interno</label>
                      <textarea rows="4" placeholder="Comentarios o datos adicionales" [(ngModel)]="data.datosAdicionales"
                      class="form-control" formControlName="datosAdicionales"></textarea>
                  </div>

                  <div class="col-md-4"><br>
                    <label><i class="fa fa-bolt"></i> Datos de irregularidades para cartas</label>
                    <textarea rows="4" placeholder="Comentarios o datos adicionales" [(ngModel)]="data.datosIrregulares"
                    class="form-control" formControlName="datosIrregularidades"></textarea>
                </div>

                <div class="col-md-4" *ngIf="data.estado > 1"><br>
                    <label><i class="fa fa-calculator"></i> Datos adicionales de cálculo</label>
                    <textarea rows="4" placeholder="Datos adicionales de cálculo" [(ngModel)]="data.datosCalculo"
                    class="form-control" formControlName="datosCalculo"></textarea>
                </div>

                  </div>
                  <br>
                </form>
                
                <div class="row">
                  <div class="col-lg-12"><br>
                    <hr style="background-color: #D1D104 !important; height: 2px;">
                    <h4 style="color: #D1D104;">
                        <img class="img-profile" src="./assets/imagenes/search.png"
                        style="margin-bottom: 5px;">
                        Agregar documentación probatoria del caso
                    </h4>
                    <form [formGroup]='frm_Archivo'>
                      <div class="row">
                        <div class="col-md-4">
                          <label><i class="fas fa-pencil"></i> Titulo del archivo</label>
                          <textarea  name="tituloDocProbatorio" formControlName="tituloDocProbatorio"  rows="2" class="form-control"
                          placeholder="Titulo del documento"></textarea>
                             
                        </div>
                        <div class="col-md-3">
                          <label><i class="fas fa-file"></i> Tipo de archivo</label>
                          <select class="form-control" name="tipoPruebaProbatorio" formControlName="tipoPruebaProbatorio">
                            <option value="1">Seleccione</option>
                            <option value="Fotografía">Fotografía</option>
                            <option value="Documento">Documento</option>
                            <option value="Otro">Otro</option>
                        </select>
                        </div>
                        <div class="col-md-5">
                          <label><i class="fas fa-upload"></i> Seleccione el archivo</label>
                          <input type="file" name="file" (change)="fileProgress($event)" class="form-control"
                          formControlName="fileProbatorio" style="height:45px"/>
                          <br>
                          <div *ngIf="fileUploadProgress" style="color:white">
                            Upload progress: {{ fileUploadProgress }}
                        </div>
                        <div class="image-preview mb-3" *ngIf="previewUrl">
                            <img [src]="previewUrl" height="150" style="margin-left:25%;"/>    
                           
                        </div>
                        
                        <div class="mb-3" *ngIf="uploadedFilePath">
                            {{uploadedFilePath}}
                        </div>
            
                        </div>
                        
                      
                      <div class="col-md-2"></div>
                      <div class="col-md-8">  
                        <button class="btn btn-warning btn-block"  (click)="onSubmit(ordenNumeroG.caso)">
                          <i class="fas fa-upload"></i> Cargar Archivo
                         </button>
                      </div>
                      <div class="col-md-2"></div>
                    </div><br>
                    </form>
                    <h5 style="color: #FAC092;">Listado de archivos nuevos cargados</h5>
                    <form [formGroup]="docForm">
                        
                        <table class="table small mt-3">
                            <thead class="thead-dark">
                                <tr >
                                    <th style="background-color:#1B1B38; color:#B0B005;font-size: 14px;
                                    border-bottom: 2px solid #B0B005;font-weight: bold;" class="text-center">
                                        <label class="fa fa-pen" style="color:#B0B005 !important;"></label>
                                        Título
                                    </th>
                                    <th style="background-color:#1B1B38; color:#B0B005;font-size: 14px;
                                    border-bottom: 2px solid #B0B005;font-weight: bold;" class="text-center">
                                        <label class="fa fa-archive" style="color:#B0B005 !important;"></label>
                                        Tipo de prueba
                                    </th>
                                    <th style="background-color:#1B1B38; color:#B0B005;font-size: 14px;
                                    border-bottom: 2px solid #B0B005;font-weight: bold;" class="text-center">
                                        <label class="fa fa-file" style="color:#B0B005 !important;"></label>
                                        Archivo
                                    </th>
                                </tr>
                            </thead>
                            <tbody  formArrayName="documentacion"
                            style="background-color:#222245; color:white;text-align: center;
                            font-size: 14px;">
                                <tr *ngFor="let item of documentos.controls; let pointIndex=index" [formGroupName]="pointIndex">
                                    <td style="border-bottom: 1px solid white;"><textarea 
                                        formControlName="nombreDoc" readonly="true"
                                        name="tituloDoc"  rows="2" class="form-control" placeholder="Titulo del documento"></textarea>
                                      <input type="hidden" name="caso" formControlName="caso" class="form-control"></td>
                                    <td style="border-bottom: 1px solid white;">
                                        <select disabled class="form-control" name="tipoPrueba" formControlName="tipoPrueba">
                                        <option value="1">Seleccione</option>
                                        <option value="Fotografía">Fotografía</option>
                                        <option value="Documento">Documento</option>
                                        <option value="Otro">Otro</option>
                                    </select></td>
                                    <td style="border-bottom: 1px solid white;">
                                        <input class="form-control" type="text" formControlName="archivo"
                                        style="height: 45px;" readonly="true"></td>
                                    </tr>
                                
                            </tbody>
                        </table>
                    </form>
                    <br><br>
                    <hr style="background-color: #3AF415 !important; height: 2px;">
                    <button class="btn btn-success btn-block" style="font-weight: bold !important;"
                    data-dismiss="modal"
                    data-toggle="modal" data-target="#guardarDatosConfirm">
                      <i class="fas fa-save"></i> Guardar Todo
                    </button>
                
                    
                    </div>
                </div>
              </div>
            </div>
            <div class="tab-pane" id="docAdjuntosCN" role="tabpanel" aria-labelledby="">
              <div class="row animated fadeInLeft" 
              style="margin-left: 30px;margin-right: 30px;margin-top: 30px;margin-bottom: 30px;" >
              
              <div class="col-lg-12">
                <hr style="background-color: #D1D104 !important; height: 2px;">
              <h4 style="color: #D1D104;">
                  <img class="img-profile" src="./assets/imagenes/document.png">
                  Adjuntos del caso
              </h4>
              </div>
              <div class="col-md-12" style="max-height: 400px; overflow-y: auto;
                overflow-x: auto;
                margin-top: 25px;">
                <table  id="adjuntos_Tbl" class="table small mt-5" style="width: 100%;
                margin:auto">
                    <thead class="thead-dark">
                    <tr>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Título</th>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Fecha de Creación</th>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Usuario Creador</th>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Archivo</th>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Acciones</th>
                    </tr>
                    </thead>
                    <tbody style="background-color:#323259; color:white;text-align: center;
                    font-size: 13px;">
                    <tr *ngFor="let ad  of adjuntosFile" >                        
                    <td >{{ad.titulo}}</td>
                    <td>{{ad.fechaCreacion}}</td>
                    <td>{{ad.creador}}</td>
                    <td>{{ad.ruta}}</td>
                    <td>
                        <button class="btn btn-success btn-sm btn-circle"  data-dismiss="modal"
                        (click)="adjuntosOrdenesVer(ad.ruta, ad.ext)"
                        data-toggle="modal" data-target="#verAdjuntosOrden">
                                <i class="fa fa-eye"></i>
                    </button> 
                        &nbsp; 
                        <a class="btn btn-info btn-sm btn-circle"  
                        [href]="rutaFile+ad.ruta">
                                <i class="fa fa-download"></i>
                        </a>
                    &nbsp;
                        <button data-dismiss="modal" data-toggle="modal"
                            data-target="#confirmarEliminarAdjunto"
                        (click)="datosEliminarArch(ad.ruta, ad.id, ad)"
                            class="btn btn-danger btn-sm btn-circle">
                            <i class="fa fa-trash"></i>
                        </button>
                    </td>
                    
                        </tr>
                    </tbody>
                </table>
              </div>
              
              </div>
            </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal"
        data-toggle="modal" data-target="#cancelarGuardadoEditar">
          <i class="fas fa-times-circle"></i>  Cerrar!
        </button>
      </div>
    </div>
  </div>
</div>


<!--Modal para ver datos de caso ENR notificados-->
<div class="modal animated fadeInDown" id="datosCasoNoti" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog mw-100 w-75" >
    <div class="modal-content">
      <div class="modal-header" >
        
        <div class="row" style="margin-left: 30px;">
          <ul class="nav nav-tabs" id="myTab" role="tablist" >
          <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#datosNISN" role="tab"
            aria-controls="home" aria-selected="true" style="color:#FB51EE;background-color: #1B1B38;">
            <i class="fas fa-cogs"></i>
            Datos del NIS
            </a>
          </li>
          <li class="nav-item" style="border-bottom:1px solid white;">
            <a class="nav-link"  data-toggle="tab" href="#ordenesNISN" role="tab"
            aria-controls="profile" aria-selected="false" style="color:#51F749;background-color: #1B1B38;">
            <i class="fas fa-paperclip"></i>
                Órdenes tec. del NIS
            </a>
          </li>
          <li class="nav-item" style="border-bottom:1px solid white;">
            <a class="nav-link"  data-toggle="tab" href="#datosENRN" role="tab"
            aria-controls="profile" aria-selected="false" style="color:#49F7DD;background-color: #1B1B38;">
            <i class="fas fa-money-bill-alt"></i>
                Datos de ENR
            </a>
          </li>
          <li class="nav-item" style="border-bottom:1px solid white;">
            <a class="nav-link"  data-toggle="tab" href="#docAdjuntosN" role="tab"
            aria-controls="profile" aria-selected="false" style="color:#D1D104;background-color: #1B1B38;">
            <i class="fas fa-file"></i>
                Adjuntos
            </a>
          </li>
        </ul>
        </div>
        <h6 class="title" style="color:#B18AFF !important;margin-right: 40px;">
          Caso N°: <a style="color: #0CD902;">{{ordenNumeroG.caso}}</a><br>
          Usuario creacion: <a style="color: #0CD902;">{{ordenNumeroG.usuarioCreacion}}</a> 
        </h6>
      </div>
      <div class="modal-body" style="max-height: calc(100vh - 200px);
      overflow-y: auto;overflow-x: hidden;">
        
        <div class="tab-content" id="myTabContent" style="background-color: #323259;margin-right: 30px;
        margin-left: 30px;border: 1px solid white;
       max-height: calc(100vh - 200px);
      overflow-y: auto;overflow-x: hidden;">
            <div class="tab-pane fade show active" id="datosNISN" role="tabpanel" aria-labelledby="">
              <div class="row animated fadeInRight" *ngFor="let dat  of datos">
                
                <form [formGroup]='frm_DatosNIS'>
                  <div class="row" style="margin-left: 30px;margin-right: 30px;margin-top: 30px;margin-bottom: 30px;" >
                    <div class="col-lg-12">
                      <hr style="background-color: #FB51EE !important;height: 2px;">
              
                      <h4 style="color: #FB51EE;">
                          <img class="img-profile" src="./assets/imagenes/result.png"
                          style="margin-bottom: 5px;">
                          Datos obtenidos
                      </h4>
                  </div>  
                    <div class="col-md-6">
                          <label><i class="fa fa-user"></i> Usuario</label>          
                          <input type="text" class="form-control"  placeholder="Usuario" readonly="true"
                          formControlName="usuario" name="usuario" [(ngModel)]="dat.usuario">    
                          <input type="hidden" class="form-control"  placeholder="Usuario" readonly="true"
                          formControlName="num_suministro" name="num_suministro" [(ngModel)]="dat.num_suministro">     
                      </div>
                      <div class="col-md-6">
                          <label><i class="fa fa-address-card"></i> Dirección</label>
                          <textarea rows="3" class="form-control"  placeholder="Dirección" readonly="true"
                          formControlName="direccion" name="direccion" [(ngModel)]="dat.direccion"></textarea>     
                      </div>
                      <div class="col-md-6"><br>
                          <label><i class="fa fa-home"></i> Municipio</label>          
                          <input type="text" class="form-control"  placeholder="Municipio" readonly="true"
                          formControlName="municipio" name="municipio" [(ngModel)]="dat.municipio">         
                      </div>
                      <div class="col-md-6"><br>
                          <label><i class="fa fa-home"></i> Colonia</label>
                          <input type="text" class="form-control"  placeholder="Colonia" readonly="true"
                          formControlName="colonia" name="colonia" [(ngModel)]="dat.colonia">    
                      </div>
                      <div class="col-md-4"><br>
                          <label><i class="fa fa-network-wired"></i> Red Eléctrica asociada</label>          
                          <input type="text" class="form-control"  placeholder="Red Eléctrica asociada" 
                          formControlName="red_electrica" name="red_electrica" readonly="true" [(ngModel)]="dat.red_electrica">         
                      </div>
                      <div class="col-md-4"><br>
                          <label><i class="fa fa-bolt"></i> Trafo</label>          
                          <input type="text" class="form-control"  placeholder="Trafo" 
                          formControlName="trafo" name="trafo" readonly="true" [(ngModel)]="dat.trafo">         
                      </div>
                      <div class="col-md-4"><br>
                          <label><i class="fa fa-project-diagram"></i> N° de Medidor</label>
                          <input type="text" class="form-control"  placeholder="N° de Medidor" formControlName="medidor" name="medidor"
                          readonly="true" [(ngModel)]="dat.medidor">    
                      </div>
                  </div>
                </form>
               

                
              </div>
            </div>


            <div class="tab-pane" id="ordenesNISN" role="tabpanel" aria-labelledby="">
              <div class="row animated fadeInLeft" 
              style="margin-left: 30px;margin-right: 30px;margin-top: 30px;margin-bottom: 30px;" >
                <div class="col-lg-12">
                  <hr style="background-color: #51F749 !important; height: 2px;">
                  <h4 style="color: #51F749;">
                      <img class="img-profile" src="./assets/imagenes/order.png"
                      style="margin-bottom: 5px;">
                      Órdenes téNicas asociadas al suministro
                  </h4>
                </div>
                <div class="col-md-12" style="max-height: 400px; overflow-y: auto;
                overflow-x: auto;
                margin-top: 25px;">
                    <table  id="ordenesTbl" class="table small mt-5" style="width: 99%;
                    margin:auto">
                        <thead class="thead-dark">
                          <tr>
                            <th style="background-color:#323259; color:#51F749;"
                            class="text-center">N° Orden</th>
                            <th style="background-color:#323259; color:#51F749;"
                            class="text-center">Tipo Orden</th>
                           
                            <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Fecha de asignación</th>
                            <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Descripción</th>
                             <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Usuario resolución</th>
                             <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Fecha de resolución</th>
                             <th style="background-color:#323259; color:#51F749;"
                             class="text-center">Acciones</th>
                        </tr>
                        </thead>
                        <tbody style="background-color:#323259; color:white;text-align: center;
                        font-size: 13px;">
                          <tr *ngFor="let orden  of ordenes" 
                          [ngClass]="{adjuntos: orden.adjuntos > 0}">                        
                           <td >{{orden.orden}}</td>
                           <td style="width: 50%;">{{orden.tipo}}</td>
                           
                           <td>{{orden.fechaAsig}}</td>
                           <td style="width: 50%;">
                                <div style="width:100%; max-height:60px; overflow:auto">
                                    {{orden.descripcion}}
                                </div>
                            </td>
                            <td>{{orden.resolucion}}</td>
                           <td>{{orden.fechaRes}}</td>
                           <td>
                           
                            <button class="btn btn-success btn-sm btn-circle" style="background-color: #51F749;
                           color:black" data-dismiss="modal" data-toggle="modal" data-target="#adjuntarArchivosOrden"
                           (click)="modalAdjuntar(orden, ordenNumeroG)">
                                <i class="fa fa-paperclip"></i>
                           </button> 
                           &nbsp; 
                           <button *ngIf="orden.adjuntos > 0" data-dismiss="modal" data-toggle="modal" 
                             data-target="#adjuntosOrden" (click)="adjuntosOrdenes(orden, ordenNumeroG)"
                            class="btn btn-info btn-sm btn-circle" style="background-color: #008EC4;color:white">
                             <i class="fa fa-eye"></i>
                        </button>
                        </td>
                          
                            </tr>
                        </tbody>
                      </table>
                     
    
                 
                </div>
              </div>
            </div>

            <div class="tab-pane" id="datosENRN" role="tabpanel" aria-labelledby="">
              <div class="row animated fadeInRight"
              style="margin-left: 30px;margin-right: 30px;margin-top: 30px;margin-bottom: 30px;" >
                <div class="col-lg-12">
                  <hr style="background-color: #49F7DD !important; height: 2px;">
                  <h4 style="color: #49F7DD;">
                      <img class="img-profile" src="./assets/imagenes/cost.png"
                      style="margin-bottom: 5px;">
                      Generales Cálculo ENR
                  </h4>
                </div>
                <form [formGroup]='frmDatosENR'>
                  <div class="row" *ngFor="let data  of datosENRLista">
                    <div class="col-md-6"><br>
                      <label><i class="fa fa-barcode"></i> Número de Notificación ENR</label>          
                      <input type="text" class="form-control"  placeholder="Número de Notificación ENR"
                      formControlName="nNotificacion" [(ngModel)]="data.nNotiENR">
                      <input type="hidden" class="form-control" 
                      formControlName="caso" [(ngModel)]="data.id">
                    </div>
                    <div class="col-md-6"><br>
                        <label><i class="fa fa-file"></i> Adjunto: Scan de notificacion inicial</label>          
                        <br>
                        <h6 style="color: yellow;font-size: 13px;">{{data.ruta}}</h6>
                        <button class="btn btn-success btn-sm btn-circle"  data-dismiss="modal"
                        (click)="adjuntosOrdenesVer(data.ruta, data.ext)"
                        data-toggle="modal" data-target="#verAdjuntosOrden">
                                <i class="fa fa-eye"></i>
                      </button> 
                        &nbsp; 
                        <a class="btn btn-info btn-sm btn-circle"  
                        [href]="rutaFile+data.ruta">
                                <i class="fa fa-download"></i>
                        </a>
                        &nbsp; 
                        
                  
                    </div>
                    <div class="col-md-6"><br>
                        <label><i class="fa fa-calendar"></i> Fecha de primera notificación </label>          
                        <input type="date" class="form-control"  formControlName="fechaPrimeraNoti"
                        [(ngModel)]="data.fechaPri" readonly="true">
                  
                    </div>
                    <div class="col-md-6"><br>
                        <label><i class="fa fa-calendar"></i> Fecha de Regularización</label>          
                        <input type="date" (change)="asigFechaFin()" class="form-control" formControlName="fechaRegular"
                        [(ngModel)]="data.fechaR" readonly="true">
                  
                    </div>  
                    <div class="col-md-5"><br>
                        <label><i class="fa fa-archive"></i> Tipo de Caso ENR</label>          
                        <select (change)="asigDias()" class="form-control" formControlName="codTipoENR"
                        [(ngModel)]="data.codigoTipoENR" disabled="true">
                            <option value="0" set selected> Seleccione una opción</option>
                            <option *ngFor="let codENR of codigosENR"  value="{{codENR.id}}">
                                {{codENR.codigoTipo}} -- {{codENR.TipoENR}}
                            </option>
                        </select>         
                    </div>
                    <div class="col-md-2" id="diasData"><br> 
                      <div  *ngFor="let dia  of dias">
                        <label><i class="fa fa-calendar"></i> T. Retroactivo</label>
                        <input type="text" readonly="true" formControlName="diasRetroactivos" class="form-control" [(ngModel)]="dia.diasRetro">
                    </div> 
                    </div>
                     
                   
                    <div class="col-md-5"><br>
                        <label><i class="fa fa-archive"></i> Tipo de Cálculo de metodología ENR</label>          
                        <select class="form-control" formControlName="codTipoMetENR" disabled="true" [(ngModel)]="data.codigoTipoMet">
                            <option value="0" set selected> Seleccione una opción</option>
                            <option *ngFor="let codMetENR of codigosMetENR" value="{{codMetENR.id}}">
                                {{codMetENR.codigo}} -- {{codMetENR.TipoENR}}
                            </option>
                        </select>
                  
                    </div>
        
                    <div class="col-md-4"><br>
                        <label><i class="fa fa-calendar"></i> Fecha de Inicio</label>
                        <input type="date" [(ngModel)]="data.fechaIn" readonly="true" (change)="validarFechaInicio()" class="form-control" formControlName="fechaInicioENR">
                    </div>
                    <div class="col-md-4"><br>
                        <label><i class="fa fa-calendar"></i> Fecha Fin (Limite es fecha regularización)</label>
                        <input type="date" (change)="validarFechas()"   [(ngModel)]="data.fechaFin"
                        id="fechaf" class="form-control" formControlName="fechaFinENR" readonly="true">
                    </div>
                    <div class="col-md-4"><br>
                        <label><i class="fa fa-money-check-alt"></i> Días de Cobro ENR</label>
                        <input type="text" placeholder="Días de Cobro ENR" [(ngModel)]="data.diasCobro"
                        class="form-control" formControlName="diasCobro" readonly="true">
                    </div>
                    <div class="col-md-4"><br>
                      <label><i class="fa fa-comments"></i> Datos adicionales para control interno</label>
                      <textarea rows="4" placeholder="Comentarios o datos adicionales" [(ngModel)]="data.datosAdicionales"
                      class="form-control" formControlName="datosAdicionales"></textarea>
                  </div>

                  <div class="col-md-4"><br>
                    <label><i class="fa fa-bolt"></i> Datos de irregularidades para cartas</label>
                    <textarea rows="4" placeholder="Comentarios o datos adicionales" [(ngModel)]="data.datosIrregulares"
                    class="form-control" formControlName="datosIrregularidades"></textarea>
                </div>

                <div class="col-md-4" *ngIf="data.estado > 1"><br>
                    <label><i class="fa fa-calculator"></i> Datos adicionales de cálculo</label>
                    <textarea rows="4" placeholder="Datos adicionales de cálculo" [(ngModel)]="data.datosCalculo"
                    class="form-control" formControlName="datosCalculo"></textarea>
                </div>

                  </div>
                  <br>
                </form>
                
                
              </div>
            </div>
            <div class="tab-pane" id="docAdjuntosN" role="tabpanel" aria-labelledby="">
              <div class="row animated fadeInLeft" 
              style="margin-left: 30px;margin-right: 30px;margin-top: 30px;margin-bottom: 30px;" >
              
              <div class="col-lg-12">
                <hr style="background-color: #D1D104 !important; height: 2px;">
              <h4 style="color: #D1D104;">
                  <img class="img-profile" src="./assets/imagenes/document.png">
                  Adjuntos del caso
              </h4>
              </div>
              <div class="col-md-12" style="max-height: 400px; overflow-y: auto;
                overflow-x: auto;
                margin-top: 25px;">
                <table  id="adjuntos_Tbl" class="table small mt-5" style="width: 100%;
                margin:auto">
                    <thead class="thead-dark">
                    <tr>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Título</th>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Fecha de Creación</th>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Usuario Creador</th>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Archivo</th>
                        <th style="background-color:#323259; color:#51F749;"
                        class="text-center">Acciones</th>
                    </tr>
                    </thead>
                    <tbody style="background-color:#323259; color:white;text-align: center;
                    font-size: 13px;">
                    <tr *ngFor="let ad  of adjuntosFile" >                        
                    <td >{{ad.titulo}}</td>
                    <td>{{ad.fechaCreacion}}</td>
                    <td>{{ad.creador}}</td>
                    <td>{{ad.ruta}}</td>
                    <td>
                        <button class="btn btn-success btn-sm btn-circle"  data-dismiss="modal"
                        (click)="adjuntosOrdenesVer(ad.ruta, ad.ext)"
                        data-toggle="modal" data-target="#verAdjuntosOrden">
                                <i class="fa fa-eye"></i>
                    </button> 
                        &nbsp; 
                        <a class="btn btn-info btn-sm btn-circle"  
                        [href]="rutaFile+ad.ruta">
                                <i class="fa fa-download"></i>
                        </a>
                    &nbsp;
                        <button data-dismiss="modal" data-toggle="modal"
                            data-target="#confirmarEliminarAdjunto"
                        (click)="datosEliminarArch(ad.ruta, ad.id, ad)"
                            class="btn btn-danger btn-sm btn-circle">
                            <i class="fa fa-trash"></i>
                        </button>
                    </td>
                    
                        </tr>
                    </tbody>
                </table>
              </div>
              
              </div>
            </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal"
        data-toggle="modal" data-target="#cancelarGuardadoEditar">
          <i class="fas fa-times-circle"></i>  Cerrar!
        </button>
      </div>
    </div>
  </div>
</div>




<div class="modal animated fadeInDown" id="mdEliminarCaso" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="title" style="color:#0CD902 !important;">
          <img class="img-profile" src="./assets/imagenes/confirm.png" width=35 height=35>
          Confirmación
        </h5>
        
      </div>
      <div class="modal-body">
        <h4 style="text-align: center;color: #67E1E1;">¿Desea eliminar el caso ENR {{casoEliminar}}?</h4>
        
          <form [formGroup]="frmDatosEliminar">
            <div class="row" style="width: 100%; text-align: center !important;">
              <div class="col-md-12">
                <label><i class="fas fa-pen"></i> Escriba la razón por la que desea eliminar el caso: </label>
                <textarea rows="4" placeholder="Razón de eliminado" class="form-control"
                formControlName="razonEliminado"></textarea>

                <input formControlName="usuario" type="hidden">
                <input formControlName="idCaso"type="hidden">
              </div>
            </div>
          </form>
      
        

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">
          <i class="fas fa-times-circle"></i>  Cancelar!
        </button>
        <button type="button" [disabled] = "frmDatosEliminar.invalid" class="btn btn-success" data-dismiss="modal"
        (click)="eliminarCasoBD()">
          <i class="fas fa-thumbs-up"></i> Eliminar!
        </button>
        
        
      </div>
    </div>
  </div>
</div>